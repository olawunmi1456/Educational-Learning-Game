<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Educational Games Platform - Upload and Play HTML5 Games">
    <title>EducationalGamez.com | Upload & Play Games</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Base Styles & Variables */
        :root {
            --primary: #4a6fa5;
            --secondary: #6b8cbc;
            --accent: #ff9e5d;
            --light: #f0f5ff;
            --dark: #2c3e50;
            --success: #5cb85c;
            --danger: #d9534f;
            --warning: #f0ad4e;
            --radius: 12px;
            --shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
            --max-width: 1400px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        /* Skip to main content for accessibility */
        .skip-to-content {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--accent);
            color: white;
            padding: 8px 16px;
            z-index: 1001;
            text-decoration: none;
            border-radius: 0 0 var(--radius) 0;
            transition: var(--transition);
        }
        
        .skip-to-content:focus {
            top: 0;
        }
        
        /* Header & Navigation */
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 1rem 5%;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: var(--max-width);
            margin: 0 auto;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            color: white;
        }
        
        .logo i {
            font-size: 2rem;
            color: var(--accent);
        }
        
        .logo h1 {
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        /* Navigation */
        nav {
            position: relative;
        }
        
        .nav-list {
            display: flex;
            list-style: none;
            gap: 1.5rem;
            margin: 0;
            padding: 0;
        }
        
        .nav-list a {
            color: white;
            text-decoration: none;
            font-weight: 600;
            font-size: 1rem;
            transition: var(--transition);
            padding: 0.5rem 0.8rem;
            border-radius: var(--radius);
            display: block;
        }
        
        .nav-list a:hover,
        .nav-list a:focus {
            background-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            outline: 2px solid white;
        }
        
        .nav-list a.active {
            background-color: rgba(255, 255, 255, 0.25);
        }
        
        .auth-buttons {
            display: flex;
            gap: 0.75rem;
            align-items: center;
        }
        
        .btn {
            padding: 0.6rem 1.2rem;
            border-radius: var(--radius);
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.95rem;
        }
        
        .btn-primary {
            background-color: var(--accent);
            color: white;
        }
        
        .btn-primary:hover,
        .btn-primary:focus {
            background-color: #ff8e42;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(255, 158, 93, 0.4);
            outline: none;
        }
        
        .btn-secondary {
            background-color: transparent;
            color: white;
            border: 2px solid white;
        }
        
        .btn-secondary:hover,
        .btn-secondary:focus {
            background-color: white;
            color: var(--primary);
            outline: none;
        }
        
        .btn-success {
            background-color: var(--success);
            color: white;
        }
        
        .btn-danger {
            background-color: var(--danger);
            color: white;
        }
        
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: var(--radius);
        }
        
        .mobile-menu-btn:hover,
        .mobile-menu-btn:focus {
            background-color: rgba(255, 255, 255, 0.1);
            outline: 2px solid white;
        }
        
        /* Hero Section */
        .hero {
            padding: 3rem 5%;
            background: linear-gradient(rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.9)), 
                        url('https://images.unsplash.com/photo-1516321318423-f06f85e504b3?ixlib=rb-4.0.3&auto=format&fit=crop&w=1170&q=80');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }
        
        .hero-container {
            max-width: var(--max-width);
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            align-items: center;
        }
        
        .hero-content h2 {
            font-size: 2.5rem;
            color: var(--dark);
            margin-bottom: 1rem;
            line-height: 1.2;
        }
        
        .hero-content p {
            font-size: 1.1rem;
            margin-bottom: 2rem;
            color: #555;
        }
        
        .hero-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .hero-image {
            background-color: var(--primary);
            border-radius: var(--radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            transform: perspective(1000px) rotateY(-5deg);
            transition: var(--transition);
        }
        
        .hero-image:hover {
            transform: perspective(1000px) rotateY(0deg) scale(1.02);
        }
        
        .game-preview {
            background-color: white;
            border-radius: var(--radius);
            padding: 1.5rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            text-align: center;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        .game-preview img {
            width: 100%;
            height: auto;
            border-radius: var(--radius);
            margin-bottom: 1.5rem;
            border: 2px solid var(--light);
        }
        
        /* Games Library Section */
        .games-library {
            padding: 4rem 5%;
            background-color: white;
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 3rem;
        }
        
        .section-title h2 {
            font-size: 2.2rem;
            margin-bottom: 0.5rem;
            color: var(--dark);
        }
        
        .section-title p {
            color: #666;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .library-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .search-box {
            position: relative;
            flex-grow: 1;
            max-width: 400px;
        }
        
        .search-box input {
            width: 100%;
            padding: 0.8rem 1rem 0.8rem 2.5rem;
            border: 2px solid #ddd;
            border-radius: var(--radius);
            font-size: 1rem;
            transition: var(--transition);
        }
        
        .search-box input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(74, 111, 165, 0.1);
        }
        
        .search-box i {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: #777;
        }
        
        .filter-buttons {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            padding: 0.5rem 1rem;
            background-color: white;
            border: 2px solid var(--light);
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .filter-btn:hover,
        .filter-btn:focus {
            border-color: var(--primary);
            outline: none;
        }
        
        .filter-btn.active {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .game-card {
            background-color: white;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            border: 1px solid #eee;
        }
        
        .game-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.12);
        }
        
        .game-card.uploaded {
            border-left: 5px solid var(--success);
        }
        
        .game-image {
            height: 180px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3.5rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            position: relative;
        }
        
        .game-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .game-type-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: var(--accent);
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
        }
        
        .game-info {
            padding: 1.5rem;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        
        .game-info h3 {
            margin-bottom: 0.5rem;
            color: var(--dark);
            font-size: 1.2rem;
        }
        
        .game-meta {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            color: #777;
            font-size: 0.9rem;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        
        .game-desc {
            margin-bottom: 1.5rem;
            color: #555;
            font-size: 0.95rem;
            flex-grow: 1;
        }
        
        .game-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .play-btn {
            flex-grow: 1;
            padding: 0.7rem;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: var(--radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .play-btn:hover,
        .play-btn:focus {
            background-color: var(--secondary);
            outline: none;
        }
        
        .delete-btn {
            padding: 0.7rem;
            background-color: var(--light);
            color: var(--danger);
            border: none;
            border-radius: var(--radius);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
        }
        
        .delete-btn:hover,
        .delete-btn:focus {
            background-color: var(--danger);
            color: white;
            outline: none;
        }
        
        .empty-state {
            text-align: center;
            padding: 3rem;
            color: #777;
        }
        
        .empty-state i {
            font-size: 4rem;
            color: #ddd;
            margin-bottom: 1rem;
        }
        
        /* Upload Section */
        .upload-section {
            padding: 4rem 5%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }
        
        .upload-container {
            max-width: 900px;
            margin: 0 auto;
            text-align: center;
        }
        
        .upload-container h2 {
            font-size: 2.2rem;
            margin-bottom: 1rem;
        }
        
        .upload-container p {
            margin-bottom: 2rem;
            font-size: 1.1rem;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .upload-box {
            background-color: rgba(255, 255, 255, 0.1);
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: var(--radius);
            padding: 3rem 2rem;
            margin-top: 2rem;
            transition: var(--transition);
            cursor: pointer;
            position: relative;
        }
        
        .upload-box:hover,
        .upload-box.dragover {
            background-color: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.5);
        }
        
        .upload-box i {
            font-size: 3rem;
            margin-bottom: 1.5rem;
            color: var(--accent);
        }
        
        .upload-formats {
            font-size: 0.9rem;
            margin-top: 1rem;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .upload-button-container {
            margin-top: 2rem;
        }
        
        .upload-button {
            font-size: 1rem;
            padding: 0.9rem 1.8rem;
        }
        
        #fileInput {
            display: none;
        }
        
        .upload-progress {
            margin-top: 1rem;
            display: none;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }
        
        .progress-fill {
            height: 100%;
            background-color: var(--accent);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .upload-details {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-top: 2rem;
            text-align: left;
            display: none;
        }
        
        .upload-details h3 {
            margin-bottom: 1rem;
            color: var(--accent);
        }
        
        .file-list {
            list-style: none;
            margin-bottom: 1.5rem;
        }
        
        .file-list li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .file-list li:last-child {
            border-bottom: none;
        }
        
        .file-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .file-size {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
            text-align: left;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: var(--radius);
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
            transition: var(--transition);
        }
        
        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(255, 158, 93, 0.2);
        }
        
        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        /* Game Player Modal */
        .game-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .game-modal.active {
            display: flex;
            opacity: 1;
        }
        
        .modal-content {
            background-color: white;
            border-radius: var(--radius);
            width: 100%;
            max-width: 1200px;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }
        
        .game-modal.active .modal-content {
            transform: scale(1);
        }
        
        .modal-header {
            padding: 1.2rem 1.5rem;
            background-color: var(--primary);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .close-modal {
            background: none;
            border: none;
            color: white;
            font-size: 1.8rem;
            cursor: pointer;
            transition: var(--transition);
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }
        
        .close-modal:hover,
        .close-modal:focus {
            background-color: rgba(255, 255, 255, 0.2);
            outline: none;
        }
        
        .game-frame {
            flex-grow: 1;
            border: none;
            min-height: 500px;
            width: 100%;
            background-color: #f5f5f5;
        }
        
        .modal-loader {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 3rem;
            flex-grow: 1;
        }
        
        .loader {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        /* Login/Signup Modal */
        .auth-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .auth-modal.active {
            display: flex;
            opacity: 1;
        }
        
        .auth-modal-content {
            background-color: white;
            border-radius: var(--radius);
            width: 100%;
            max-width: 450px;
            overflow: hidden;
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }
        
        .auth-modal.active .auth-modal-content {
            transform: scale(1);
        }
        
        .auth-modal-header {
            padding: 1.5rem;
            background-color: var(--primary);
            color: white;
            text-align: center;
            position: relative;
        }
        
        .auth-modal-title {
            font-size: 1.5rem;
            margin: 0;
        }
        
        .auth-close-modal {
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }
        
        .auth-close-modal:hover,
        .auth-close-modal:focus {
            background-color: rgba(255, 255, 255, 0.2);
            outline: none;
        }
        
        .auth-modal-body {
            padding: 2rem;
        }
        
        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        
        .auth-form-group {
            position: relative;
        }
        
        .auth-form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--dark);
        }
        
        .auth-form-group input {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid #ddd;
            border-radius: var(--radius);
            font-size: 1rem;
            transition: var(--transition);
        }
        
        .auth-form-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(74, 111, 165, 0.1);
        }
        
        .password-toggle {
            position: absolute;
            right: 10px;
            top: 40px;
            background: none;
            border: none;
            color: #777;
            cursor: pointer;
            font-size: 1rem;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }
        
        .password-toggle:hover,
        .password-toggle:focus {
            background-color: #f0f0f0;
            outline: none;
        }
        
        .auth-form-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
        }
        
        .auth-switch-text {
            font-size: 0.9rem;
            color: #666;
        }
        
        .auth-switch-link {
            color: var(--primary);
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 600;
            text-decoration: underline;
        }
        
        .auth-switch-link:hover,
        .auth-switch-link:focus {
            color: var(--secondary);
            outline: none;
        }
        
        .auth-error {
            color: var(--danger);
            font-size: 0.9rem;
            margin-top: 0.5rem;
            display: none;
        }
        
        .auth-error.show {
            display: block;
        }
        
        .user-menu {
            display: none;
            align-items: center;
            gap: 1rem;
        }
        
        .user-menu.active {
            display: flex;
        }
        
        .user-avatar {
            width: 36px;
            height: 36px;
            background-color: var(--accent);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .user-name {
            font-weight: 600;
        }
        
        .logout-btn {
            padding: 0.5rem 1rem;
            background-color: transparent;
            color: white;
            border: 2px solid white;
            border-radius: var(--radius);
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
        }
        
        .logout-btn:hover,
        .logout-btn:focus {
            background-color: white;
            color: var(--primary);
            outline: none;
        }
        
        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: var(--radius);
            color: white;
            font-weight: 600;
            z-index: 2001;
            transform: translateX(150%);
            transition: transform 0.3s ease;
            box-shadow: var(--shadow);
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.success {
            background-color: var(--success);
        }
        
        .notification.error {
            background-color: var(--danger);
        }
        
        .notification.warning {
            background-color: var(--warning);
        }
        
        /* Stats Container */
        .stats-container {
            margin-top: 3rem;
            display: flex;
            gap: 2rem;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.8rem;
            margin-bottom: 0.3rem;
            color: var(--accent);
        }
        
        /* Footer */
        footer {
            background-color: var(--dark);
            color: white;
            padding: 3rem 5% 1.5rem;
            margin-top: auto;
        }
        
        .footer-container {
            max-width: var(--max-width);
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        .footer-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 1rem;
        }
        
        .footer-logo i {
            font-size: 1.8rem;
            color: var(--accent);
        }
        
        .footer-links h3,
        .footer-contact h3 {
            margin-bottom: 1.2rem;
            font-size: 1.2rem;
        }
        
        .footer-links ul {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: 0.6rem;
        }
        
        .footer-links a {
            color: #ccc;
            text-decoration: none;
            transition: var(--transition);
        }
        
        .footer-links a:hover,
        .footer-links a:focus {
            color: var(--accent);
            padding-left: 5px;
            outline: none;
        }
        
        .footer-contact p {
            margin-bottom: 0.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .social-links {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .social-link {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            color: white;
            text-decoration: none;
            transition: var(--transition);
        }
        
        .social-link:hover,
        .social-link:focus {
            background-color: var(--accent);
            transform: translateY(-3px);
            outline: none;
        }
        
        .copyright {
            text-align: center;
            padding-top: 1.5rem;
            border-top: 1px solid #444;
            color: #aaa;
            font-size: 0.9rem;
        }
        
        /* Responsive Design */
        @media (max-width: 992px) {
            .hero-container {
                grid-template-columns: 1fr;
                text-align: center;
                gap: 2rem;
            }
            
            .hero-image {
                order: -1;
                max-width: 500px;
                margin: 0 auto;
            }
            
            .hero-actions {
                justify-content: center;
            }
            
            .nav-list {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background-color: var(--primary);
                flex-direction: column;
                padding: 1rem;
                border-radius: 0 0 var(--radius) var(--radius);
                box-shadow: var(--shadow);
            }
            
            .nav-list.active {
                display: flex;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .hero-content h2 {
                font-size: 2rem;
            }
            
            .section-title h2 {
                font-size: 1.8rem;
            }
            
            .upload-container h2 {
                font-size: 1.8rem;
            }
            
            .upload-box {
                padding: 2rem 1rem;
            }
            
            .library-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-box {
                max-width: 100%;
            }
            
            .stats-container {
                gap: 1.5rem;
            }
            
            .stat-value {
                font-size: 1.5rem;
            }
            
            .hero-actions {
                flex-direction: column;
                align-items: center;
            }
            
            .hero-actions .btn {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }
        }
        
        @media (max-width: 480px) {
            .header-container {
                flex-wrap: wrap;
                gap: 1rem;
            }
            
            .auth-buttons {
                order: 1;
                width: 100%;
                justify-content: center;
            }
            
            .games-grid {
                grid-template-columns: 1fr;
            }
            
            .game-actions {
                flex-direction: column;
            }
            
            .delete-btn {
                width: 100%;
            }
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease forwards;
        }
        
        /* Focus styles for accessibility */
        :focus {
            outline: 2px solid var(--accent);
            outline-offset: 2px;
        }
        
        /* Reduced motion preference */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <!-- Skip to main content for keyboard users -->
    <a href="#main-content" class="skip-to-content">Skip to main content</a>

    <!-- Header -->
    <header>
        <div class="header-container">
            <a href="#home" class="logo">
                <i class="fas fa-gamepad" aria-hidden="true"></i>
                <h1>Educational Games Platform</h1>
            </a>
            
            <nav aria-label="Main navigation">
                <button class="mobile-menu-btn" type="button" aria-label="Toggle navigation menu" aria-expanded="false">
                    <i class="fas fa-bars"></i>
                </button>
                
                <ul class="nav-list">
                    <li><a href="#home" class="active">Home</a></li>
                    <li><a href="#library">Game Library</a></li>
                    <li><a href="#upload">Upload Game</a></li>
                    <li><a href="#about">About</a></li>
                </ul>
            </nav>
            
            <div class="auth-buttons">
                <button class="btn btn-secondary" id="loginBtn" aria-label="Login to your account">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
                <button class="btn btn-primary" id="signupBtn" aria-label="Create new account">
                    <i class="fas fa-user-plus"></i> Sign Up
                </button>
            </div>
            
            <!-- User Menu (shown when logged in) -->
            <div class="user-menu" id="userMenu">
                <div class="user-avatar" id="userAvatar"></div>
                <span class="user-name" id="userName"></span>
                <button class="logout-btn" id="logoutBtn" aria-label="Logout">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero" id="home" aria-labelledby="hero-title">
        <div class="hero-container">
            <div class="hero-content fade-in">
                <h2 id="hero-title">Upload & Play HTML5 Games</h2>
                <p>Upload your educational HTML5 games and play them directly in your browser. No downloads required! Share your creations with the world or enjoy games from other developers.</p>
                <div class="hero-actions">
                    <button class="btn btn-primary" id="browseGamesBtn">
                        <i class="fas fa-gamepad"></i> Browse Games
                    </button>
                    <button class="btn btn-secondary" id="uploadHeroBtn">
                        <i class="fas fa-upload"></i> Upload Game
                    </button>
                </div>
            </div>
            
            <div class="hero-image fade-in">
                <div class="game-preview">
                    <!-- IMPORTANT: Replace this image with your actual PNG file -->
                    <!-- Make sure your image is named "Educational Game Image.png" and placed in the same folder as this HTML file -->
                    <img src="Educational Game Image.png" alt="Educational Games Platform - Interactive learning games for students">
                    
                    <h3>Quick Upload Demo</h3>
                    <p>Try uploading the sample game below to see how it works!</p>
                    <button class="play-btn" onclick="scrollToUpload()" aria-label="Upload your game">
                        <i class="fas fa-upload"></i> Try Upload
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Games Library Section -->
    <section class="games-library" id="library" aria-labelledby="library-title">
        <div class="section-title">
            <h2 id="library-title">Game Library</h2>
            <p>Browse and play uploaded HTML5 games from our community</p>
        </div>
        
        <div class="library-controls">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="gameSearch" placeholder="Search games by title, category, or description...">
            </div>
            
            <div class="filter-buttons">
                <button class="filter-btn active" data-filter="all">All Games</button>
                <button class="filter-btn" data-filter="uploaded">My Games</button>
                <button class="filter-btn" data-filter="math">Math</button>
                <button class="filter-btn" data-filter="science">Science</button>
                <button class="filter-btn" data-filter="language">Language</button>
                <button class="filter-btn" data-filter="coding">Coding</button>
            </div>
        </div>
        
        <div class="games-grid" id="gamesGrid" tabindex="-1">
            <!-- Games will be loaded here dynamically -->
        </div>
        
        <div class="empty-state" id="emptyState">
            <i class="fas fa-gamepad"></i>
            <h3>No Games Found</h3>
            <p>Upload your first game to get started!</p>
            <button class="btn btn-primary" onclick="scrollToUpload()">
                <i class="fas fa-upload"></i> Upload Game
            </button>
        </div>
    </section>

    <!-- Upload Section -->
    <section class="upload-section" id="upload" aria-labelledby="upload-title">
        <div class="upload-container">
            <h2 id="upload-title">Upload Your HTML5 Game</h2>
            <p>Upload HTML5, JavaScript, or WebGL games. Your game will be playable directly in the browser after upload.</p>
            
            <div class="upload-box" id="uploadBox" role="button" tabindex="0" 
                 aria-label="Drag and drop area for game files. Click or press enter to select files.">
                <i class="fas fa-cloud-upload-alt"></i>
                <h3>Drag & Drop Your Game Files</h3>
                <p>Or click to browse files on your computer</p>
                <p class="upload-formats">Supported: HTML, JS, CSS, images (Max: 5MB total)</p>
                
                <input type="file" id="fileInput" multiple accept=".html,.js,.css,.png,.jpg,.jpeg,.gif">
                
                <div class="upload-progress" id="uploadProgress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <p id="progressText">Uploading... 0%</p>
                </div>
            </div>
            
            <div class="upload-details" id="uploadDetails">
                <h3>Game Details</h3>
                <ul class="file-list" id="fileList"></ul>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="gameTitle">Game Title *</label>
                        <input type="text" id="gameTitle" placeholder="Enter game title" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="gameCategory">Category *</label>
                        <select id="gameCategory" required>
                            <option value="">Select category</option>
                            <option value="math">Mathematics</option>
                            <option value="science">Science</option>
                            <option value="language">Language Arts</option>
                            <option value="coding">Programming</option>
                            <option value="social">Social Studies</option>
                            <option value="arts">Arts & Creativity</option>
                            <option value="puzzle">Puzzle</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="gameDescription">Description *</label>
                    <textarea id="gameDescription" placeholder="Describe your game, learning objectives, and how to play..." required></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="gameAge">Age Range</label>
                        <input type="text" id="gameAge" placeholder="e.g., 8+, 12-16, All ages">
                    </div>
                    
                    <div class="form-group">
                        <label for="mainFile">Main HTML File *</label>
                        <select id="mainFile" required>
                            <option value="">Select main HTML file</option>
                        </select>
                    </div>
                </div>
                
                <div class="upload-button-container">
                    <button class="btn btn-success upload-button" id="saveGameBtn">
                        <i class="fas fa-save"></i> Save & Publish Game
                    </button>
                    <button class="btn btn-secondary" id="cancelUploadBtn">
                        Cancel
                    </button>
                </div>
            </div>
            
            <div class="stats-container">
                <div class="stat-item">
                    <h3 class="stat-value" id="totalGames">3</h3>
                    <p>Total Games</p>
                </div>
                <div class="stat-item">
                    <h3 class="stat-value" id="totalUploads">0</h3>
                    <p>Games Uploaded</p>
                </div>
                <div class="stat-item">
                    <h3 class="stat-value" id="totalPlays">0</h3>
                    <p>Total Plays</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Game Player Modal -->
    <div class="game-modal" id="gameModal" role="dialog" aria-labelledby="modalGameTitle" aria-modal="true">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalGameTitle">Loading Game...</h2>
                <button class="close-modal" onclick="closeGameModal()" aria-label="Close game">
                    &times;
                </button>
            </div>
            <div class="modal-loader" id="modalLoader">
                <div class="loader" aria-hidden="true"></div>
                <span class="sr-only">Loading game...</span>
            </div>
            <iframe class="game-frame" id="gameFrame" title="Game Player" 
                    sandbox="allow-scripts allow-same-origin allow-forms allow-popups"
                    aria-label="Game content area"></iframe>
        </div>
    </div>

    <!-- Login/Signup Modal -->
    <div class="auth-modal" id="authModal" role="dialog" aria-modal="true" aria-hidden="true">
        <div class="auth-modal-content">
            <div class="auth-modal-header">
                <h2 class="auth-modal-title" id="authModalTitle">Login</h2>
                <button class="auth-close-modal" id="authCloseModal" aria-label="Close authentication modal">
                    &times;
                </button>
            </div>
            <div class="auth-modal-body">
                <form class="auth-form" id="authForm">
                    <div class="auth-form-group">
                        <label for="authEmail">Email Address</label>
                        <input type="email" id="authEmail" required placeholder="Enter your email">
                    </div>
                    
                    <div class="auth-form-group">
                        <label for="authPassword">Password</label>
                        <input type="password" id="authPassword" required placeholder="Enter your password">
                        <button type="button" class="password-toggle" id="passwordToggle" aria-label="Show password">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    
                    <div class="auth-error" id="authError">
                        Invalid email or password. Please try again.
                    </div>
                    
                    <div class="auth-form-actions">
                        <button type="submit" class="btn btn-primary" id="authSubmitBtn">
                            <i class="fas fa-sign-in-alt"></i> Login
                        </button>
                        <div class="auth-switch-text">
                            <span id="authSwitchText">Don't have an account?</span>
                            <button type="button" class="auth-switch-link" id="authSwitchLink">
                                Sign Up
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification" role="alert" aria-live="polite"></div>

    <!-- Footer -->
    <footer id="about">
        <div class="footer-container">
            <div class="footer-about">
                <div class="footer-logo">
                    <i class="fas fa-gamepad"></i>
                    <h2>EducationalGamez.com</h2>
                </div>
                <p>Upload, share, and play educational HTML5 games. Our platform provides a secure sandbox for running user-uploaded games directly in the browser.</p>
                <div class="social-links">
                    <a href="#" class="social-link" aria-label="Follow us on Facebook"><i class="fab fa-facebook"></i></a>
                    <a href="#" class="social-link" aria-label="Follow us on Twitter"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="social-link" aria-label="Follow us on GitHub"><i class="fab fa-github"></i></a>
                    <a href="#" class="social-link" aria-label="Subscribe to our YouTube channel"><i class="fab fa-youtube"></i></a>
                </div>
            </div>
            
            <div class="footer-links">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="#home">Home</a></li>
                    <li><a href="#library">Game Library</a></li>
                    <li><a href="#upload">Upload Game</a></li>
                    <li><a href="#" id="devDocs">Developer Docs</a></li>
                    <li><a href="#" id="privacyPolicy">Privacy Policy</a></li>
                    <li><a href="#" id="termsOfService">Terms of Service</a></li>
                </ul>
            </div>
            
            <div class="footer-contact">
                <h3>Contact Us</h3>
                <p><i class="fas fa-envelope"></i> support@educationalgamez.com</p>
                <p><i class="fas fa-globe"></i> www.educationalgamez.com</p>
                <p><i class="fas fa-question-circle"></i> Need help uploading? Check our FAQ</p>
            </div>
        </div>
        
        <div class="copyright">
            <p>&copy; <span id="currentYear"></span> EducationalGamez.com. All rights reserved. | Games run in a secure sandbox environment</p>
        </div>
    </footer>

    <script>
        // ============================
        // USER AUTHENTICATION SYSTEM
        // ============================
        class UserAuth {
            constructor() {
                this.USERS_KEY = 'educational_games_users';
                this.CURRENT_USER_KEY = 'current_user';
                this.initStorage();
            }
            
            initStorage() {
                if (!localStorage.getItem(this.USERS_KEY)) {
                    // Create some demo users for testing
                    const demoUsers = [
                        {
                            id: 1,
                            email: 'demo@example.com',
                            password: 'demo123',
                            name: 'Demo User',
                            joined: new Date().toISOString(),
                            games: []
                        },
                        {
                            id: 2,
                            email: 'test@example.com',
                            password: 'test123',
                            name: 'Test User',
                            joined: new Date().toISOString(),
                            games: []
                        }
                    ];
                    localStorage.setItem(this.USERS_KEY, JSON.stringify(demoUsers));
                }
            }
            
            getAllUsers() {
                try {
                    return JSON.parse(localStorage.getItem(this.USERS_KEY)) || [];
                } catch (e) {
                    return [];
                }
            }
            
            getCurrentUser() {
                try {
                    return JSON.parse(localStorage.getItem(this.CURRENT_USER_KEY));
                } catch (e) {
                    return null;
                }
            }
            
            setCurrentUser(user) {
                localStorage.setItem(this.CURRENT_USER_KEY, JSON.stringify(user));
            }
            
            clearCurrentUser() {
                localStorage.removeItem(this.CURRENT_USER_KEY);
            }
            
            login(email, password) {
                const users = this.getAllUsers();
                const user = users.find(u => u.email === email && u.password === password);
                
                if (user) {
                    // Remove password from stored user object for security
                    const { password, ...userWithoutPassword } = user;
                    this.setCurrentUser(userWithoutPassword);
                    return { success: true, user: userWithoutPassword };
                }
                
                return { success: false, message: 'Invalid email or password' };
            }
            
            signup(email, password, name) {
                const users = this.getAllUsers();
                
                // Check if user already exists
                if (users.some(u => u.email === email)) {
                    return { success: false, message: 'Email already registered' };
                }
                
                // Validate email format
                if (!this.validateEmail(email)) {
                    return { success: false, message: 'Invalid email format' };
                }
                
                // Validate password
                if (password.length < 6) {
                    return { success: false, message: 'Password must be at least 6 characters' };
                }
                
                // Create new user
                const newUser = {
                    id: Date.now(), // Simple ID generation
                    email: email,
                    password: password, // In real app, this should be hashed
                    name: name || email.split('@')[0], // Use part of email as name if not provided
                    joined: new Date().toISOString(),
                    games: []
                };
                
                users.push(newUser);
                localStorage.setItem(this.USERS_KEY, JSON.stringify(users));
                
                // Remove password from stored user object
                const { password: _, ...userWithoutPassword } = newUser;
                this.setCurrentUser(userWithoutPassword);
                
                return { success: true, user: userWithoutPassword };
            }
            
            logout() {
                this.clearCurrentUser();
                return { success: true };
            }
            
            validateEmail(email) {
                const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return re.test(email);
            }
            
            updateUser(userId, updates) {
                const users = this.getAllUsers();
                const userIndex = users.findIndex(u => u.id === userId);
                
                if (userIndex !== -1) {
                    users[userIndex] = { ...users[userIndex], ...updates };
                    localStorage.setItem(this.USERS_KEY, JSON.stringify(users));
                    
                    // Update current user if it's the same user
                    const currentUser = this.getCurrentUser();
                    if (currentUser && currentUser.id === userId) {
                        this.setCurrentUser({ ...currentUser, ...updates });
                    }
                    
                    return true;
                }
                
                return false;
            }
            
            getUserById(id) {
                const users = this.getAllUsers();
                const user = users.find(u => u.id === id);
                if (user) {
                    const { password, ...userWithoutPassword } = user;
                    return userWithoutPassword;
                }
                return null;
            }
        }

        // ============================
        // GAME STORAGE MANAGEMENT
        // ============================
        class GameStorage {
            constructor() {
                this.STORAGE_KEY = 'educational_games_v2';
                this.STATS_KEY = 'game_stats_v2';
                this.MAX_STORAGE_SIZE = 5 * 1024 * 1024; // 5MB max
                this.initStorage();
            }
            
            initStorage() {
                if (!localStorage.getItem(this.STORAGE_KEY)) {
                    localStorage.setItem(this.STORAGE_KEY, JSON.stringify({
                        games: [],
                        nextId: 1
                    }));
                }
                
                if (!localStorage.getItem(this.STATS_KEY)) {
                    localStorage.setItem(this.STATS_KEY, JSON.stringify({
                        totalPlays: 0,
                        totalUploads: 0,
                        lastGameId: 0
                    }));
                }
            }
            
            getAllGames() {
                try {
                    const data = JSON.parse(localStorage.getItem(this.STORAGE_KEY));
                    return data.games || [];
                } catch (e) {
                    console.error('Error reading games from storage:', e);
                    return [];
                }
            }
            
            getGameById(id) {
                const games = this.getAllGames();
                return games.find(game => game.id === id);
            }
            
            saveGame(gameData) {
                try {
                    const data = JSON.parse(localStorage.getItem(this.STORAGE_KEY));
                    const stats = JSON.parse(localStorage.getItem(this.STATS_KEY));
                    
                    // Generate unique ID
                    const gameId = data.nextId++;
                    
                    // Create game object
                    const game = {
                        id: gameId,
                        title: gameData.title,
                        category: gameData.category,
                        description: gameData.description,
                        ageRange: gameData.ageRange || 'All ages',
                        mainFile: gameData.mainFile,
                        files: gameData.files,
                        fileCount: gameData.files ? Object.keys(gameData.files).length : 0,
                        totalSize: gameData.totalSize || 0,
                        uploadDate: new Date().toISOString(),
                        playCount: 0,
                        type: 'uploaded',
                        userId: gameData.userId || null
                    };
                    
                    // Add to games array
                    data.games.push(game);
                    
                    // Update stats
                    stats.totalUploads++;
                    stats.lastGameId = gameId;
                    
                    // Save to localStorage
                    localStorage.setItem(this.STORAGE_KEY, JSON.stringify(data));
                    localStorage.setItem(this.STATS_KEY, JSON.stringify(stats));
                    
                    return game;
                    
                } catch (e) {
                    console.error('Error saving game:', e);
                    throw new Error('Failed to save game. Storage might be full.');
                }
            }
            
            updateGame(id, updates) {
                const data = JSON.parse(localStorage.getItem(this.STORAGE_KEY));
                const gameIndex = data.games.findIndex(game => game.id === id);
                
                if (gameIndex !== -1) {
                    data.games[gameIndex] = { ...data.games[gameIndex], ...updates };
                    localStorage.setItem(this.STORAGE_KEY, JSON.stringify(data));
                    return true;
                }
                
                return false;
            }
            
            deleteGame(id) {
                const data = JSON.parse(localStorage.getItem(this.STORAGE_KEY));
                const initialLength = data.games.length;
                
                data.games = data.games.filter(game => game.id !== id);
                
                if (data.games.length !== initialLength) {
                    localStorage.setItem(this.STORAGE_KEY, JSON.stringify(data));
                    return true;
                }
                
                return false;
            }
            
            incrementPlayCount(id) {
                const stats = JSON.parse(localStorage.getItem(this.STATS_KEY));
                const game = this.getGameById(id);
                
                if (game) {
                    game.playCount = (game.playCount || 0) + 1;
                    stats.totalPlays++;
                    
                    this.updateGame(id, { playCount: game.playCount });
                    localStorage.setItem(this.STATS_KEY, JSON.stringify(stats));
                    return true;
                }
                
                return false;
            }
            
            getStats() {
                try {
                    const stats = JSON.parse(localStorage.getItem(this.STATS_KEY));
                    const games = this.getAllGames();
                    
                    return {
                        totalGames: games.length,
                        totalUploads: stats.totalUploads || 0,
                        totalPlays: stats.totalPlays || 0
                    };
                } catch (e) {
                    return {
                        totalGames: 0,
                        totalUploads: 0,
                        totalPlays: 0
                    };
                }
            }
            
            getStorageUsage() {
                const data = localStorage.getItem(this.STORAGE_KEY);
                return data ? data.length : 0;
            }
            
            clearAllGames() {
                localStorage.removeItem(this.STORAGE_KEY);
                localStorage.removeItem(this.STATS_KEY);
                this.initStorage();
            }
            
            getUserGames(userId) {
                const games = this.getAllGames();
                return games.filter(game => game.userId === userId);
            }
        }

        // ============================
        // GAME UPLOAD HANDLER
        // ============================
        class GameUploadHandler {
            constructor() {
                this.files = [];
                this.fileContents = {};
                this.maxFileSize = 1024 * 1024; // 1MB per file
                this.maxTotalSize = 5 * 1024 * 1024; // 5MB total
            }
            
            async processFiles(fileList) {
                this.files = Array.from(fileList);
                this.fileContents = {};
                
                // Check total size
                const totalSize = this.files.reduce((sum, file) => sum + file.size, 0);
                if (totalSize > this.maxTotalSize) {
                    throw new Error(`Total file size (${this.formatFileSize(totalSize)}) exceeds maximum allowed (${this.formatFileSize(this.maxTotalSize)})`);
                }
                
                // Check individual file sizes
                for (const file of this.files) {
                    if (file.size > this.maxFileSize) {
                        throw new Error(`File "${file.name}" (${this.formatFileSize(file.size)}) exceeds maximum size (${this.formatFileSize(this.maxFileSize)})`);
                    }
                    
                    // Check file type
                    if (!this.isAllowedFileType(file.name)) {
                        throw new Error(`File type not supported: ${file.name}. Supported: HTML, JS, CSS, PNG, JPG, GIF`);
                    }
                }
                
                // Read files
                for (let i = 0; i < this.files.length; i++) {
                    const file = this.files[i];
                    try {
                        const content = await this.readFileAsText(file);
                        this.fileContents[file.name] = {
                            name: file.name,
                            content: content,
                            size: file.size,
                            type: file.type,
                            lastModified: file.lastModified
                        };
                    } catch (error) {
                        throw new Error(`Failed to read file "${file.name}": ${error.message}`);
                    }
                }
                
                return {
                    files: this.fileContents,
                    totalSize: totalSize,
                    fileCount: this.files.length
                };
            }
            
            readFileAsText(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = (event) => resolve(event.target.result);
                    reader.onerror = (error) => reject(error);
                    
                    if (file.type.startsWith('image/')) {
                        // For images, read as data URL
                        reader.readAsDataURL(file);
                    } else {
                        // For text files, read as text
                        reader.readAsText(file);
                    }
                });
            }
            
            isAllowedFileType(filename) {
                const allowedExtensions = ['.html', '.htm', '.js', '.css', '.png', '.jpg', '.jpeg', '.gif'];
                const extension = filename.toLowerCase().substring(filename.lastIndexOf('.'));
                return allowedExtensions.includes(extension);
            }
            
            formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }
            
            reset() {
                this.files = [];
                this.fileContents = {};
            }
        }

        // ============================
        // GAME PLAYER
        // ============================
        class GamePlayer {
            constructor() {
                this.currentGame = null;
                this.storage = new GameStorage();
                this.platform = null; // Will be set by GamePlatform
            }
            
            setPlatform(platform) {
                this.platform = platform;
            }
            
            async playGame(gameId) {
                try {
                    let game;
                    
                    // Check if it's a sample game (negative ID) or stored game
                    if (gameId < 0) {
                        // It's a sample game - get from platform's sampleGames
                        game = this.platform ? this.platform.getSampleGameById(gameId) : null;
                        if (game) {
                            // Increment play count for sample games
                            game.playCount = (game.playCount || 0) + 1;
                            this.platform.updateStats();
                            this.platform.loadGames(); // Refresh to update play count display
                        }
                    } else {
                        // It's a stored game
                        game = this.storage.getGameById(gameId);
                        if (game) {
                            this.storage.incrementPlayCount(gameId);
                        }
                    }
                    
                    if (!game) {
                        throw new Error('Game not found');
                    }
                    
                    this.currentGame = game;
                    this.openGameModal(game);
                    
                } catch (error) {
                    this.showNotification(`Error loading game: ${error.message}`, 'error');
                }
            }
            
            openGameModal(game) {
                const modal = document.getElementById('gameModal');
                const loader = document.getElementById('modalLoader');
                const iframe = document.getElementById('gameFrame');
                const title = document.getElementById('modalGameTitle');
                
                title.textContent = game.title;
                modal.classList.add('active');
                loader.style.display = 'flex';
                iframe.style.display = 'none';
                
                // Prevent body scrolling
                document.body.style.overflow = 'hidden';
                
                // Focus close button for accessibility
                setTimeout(() => {
                    document.querySelector('.close-modal').focus();
                }, 100);
                
                // Load game after short delay
                setTimeout(() => {
                    this.loadGame(game, iframe, loader);
                }, 500);
            }
            
            async loadGame(game, iframe, loader) {
                try {
                    // Create HTML document for the game
                    const gameHtml = this.createGameHTML(game);
                    
                    // Create blob and URL
                    const blob = new Blob([gameHtml], { type: 'text/html' });
                    const url = URL.createObjectURL(blob);
                    
                    // Set iframe source
                    iframe.src = url;
                    
                    // Handle load complete
                    iframe.onload = () => {
                        setTimeout(() => {
                            loader.style.display = 'none';
                            iframe.style.display = 'block';
                        }, 300);
                    };
                    
                    // Handle errors
                    iframe.onerror = () => {
                        loader.innerHTML = `
                            <div style="text-align: center; color: var(--danger);">
                                <i class="fas fa-exclamation-triangle" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                                <h3>Error Loading Game</h3>
                                <p>The game could not be loaded.</p>
                                <button class="btn btn-primary" onclick="gamePlayer.closeGameModal()" style="margin-top: 1rem;">
                                    Close
                                </button>
                            </div>
                        `;
                    };
                    
                } catch (error) {
                    console.error('Error loading game:', error);
                    loader.innerHTML = `
                        <div style="text-align: center; color: var(--danger);">
                            <i class="fas fa-exclamation-triangle" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                            <h3>Error Loading Game</h3>
                            <p>${error.message}</p>
                            <button class="btn btn-primary" onclick="gamePlayer.closeGameModal()" style="margin-top: 1rem;">
                                Close
                            </button>
                        </div>
                    `;
                }
            }
            
            createGameHTML(game) {
                const mainFile = game.files[game.mainFile];
                if (!mainFile) {
                    throw new Error('Main HTML file not found');
                }
                
                let htmlContent = mainFile.content;
                
                // If it's an image, wrap it in HTML
                if (mainFile.name.match(/\.(png|jpg|jpeg|gif)$/i)) {
                    htmlContent = `
                        <!DOCTYPE html>
                        <html>
                        <head>
                            <meta charset="UTF-8">
                            <meta name="viewport" content="width=device-width, initial-scale=1.0">
                            <style>
                                body { 
                                    margin: 0; 
                                    padding: 20px; 
                                    display: flex; 
                                    flex-direction: column; 
                                    align-items: center; 
                                    justify-content: center; 
                                    min-height: 100vh; 
                                    background: #f5f5f5; 
                                    font-family: Arial, sans-serif; 
                                }
                                .game-container { 
                                    max-width: 800px; 
                                    width: 100%; 
                                    text-align: center; 
                                }
                                h1 { 
                                    margin-bottom: 20px; 
                                    color: #333; 
                                }
                                img { 
                                    max-width: 100%; 
                                    height: auto; 
                                    border-radius: 10px; 
                                    box-shadow: 0 4px 8px rgba(0,0,0,0.1); 
                                }
                                .info { 
                                    margin-top: 20px; 
                                    padding: 15px; 
                                    background: white; 
                                    border-radius: 10px; 
                                    box-shadow: 0 2px 4px rgba(0,0,0,0.1); 
                                }
                            </style>
                        </head>
                        <body>
                            <div class="game-container">
                                <h1>${game.title}</h1>
                                <img src="${mainFile.content}" alt="${game.title}">
                                <div class="info">
                                    <p><strong>Category:</strong> ${this.formatCategory(game.category)}</p>
                                    <p><strong>Description:</strong> ${game.description}</p>
                                    <p><strong>Age Range:</strong> ${game.ageRange}</p>
                                </div>
                            </div>
                        </body>
                        </html>
                    `;
                }
                
                // Inject game files into the HTML
                htmlContent = this.injectGameResources(htmlContent, game.files);
                
                return htmlContent;
            }
            
            injectGameResources(htmlContent, files) {
                // Replace script src references
                for (const [filename, file] of Object.entries(files)) {
                    if (filename.endsWith('.js')) {
                        // Create script tag with inline content
                        const scriptContent = `
                            <script>
                                ${file.content}
                            <\/script>
                        `;
                        htmlContent = htmlContent.replace(
                            new RegExp(`<script[^>]*src=["'][^"']*${filename.replace('.', '\\.')}[^"']*["'][^>]*><\\/script>`, 'gi'),
                            scriptContent
                        );
                    }
                    
                    if (filename.endsWith('.css')) {
                        // Create style tag with inline content
                        const styleContent = `
                            <style>
                                ${file.content}
                            </style>
                        `;
                        htmlContent = htmlContent.replace(
                            new RegExp(`<link[^>]*href=["'][^"']*${filename.replace('.', '\\.')}[^"']*["'][^>]*>`, 'gi'),
                            styleContent
                        );
                    }
                    
                    if (filename.match(/\.(png|jpg|jpeg|gif)$/i)) {
                        // Replace image src references with data URLs
                        htmlContent = htmlContent.replace(
                            new RegExp(`src=["'][^"']*${filename.replace('.', '\\.')}[^"']*["']`, 'gi'),
                            `src="${file.content}"`
                        );
                    }
                }
                
                return htmlContent;
            }
            
            formatCategory(category) {
                const categories = {
                    'math': 'Mathematics',
                    'science': 'Science',
                    'language': 'Language Arts',
                    'coding': 'Programming',
                    'social': 'Social Studies',
                    'arts': 'Arts & Creativity',
                    'puzzle': 'Puzzle',
                    'other': 'Other'
                };
                return categories[category] || category;
            }
            
            closeGameModal() {
                const modal = document.getElementById('gameModal');
                const iframe = document.getElementById('gameFrame');
                
                modal.classList.remove('active');
                iframe.src = 'about:blank';
                document.body.style.overflow = '';
                
                // Return focus
                setTimeout(() => {
                    const playBtn = document.querySelector('.play-btn:focus');
                    if (playBtn) playBtn.focus();
                }, 100);
            }
            
            showNotification(message, type = 'success') {
                const notification = document.getElementById('notification');
                notification.textContent = message;
                notification.className = `notification ${type} show`;
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
        }

        // ============================
        // AUTHENTICATION UI MANAGER
        // ============================
        class AuthUIManager {
            constructor(authSystem, platform) {
                this.authSystem = authSystem;
                this.platform = platform;
                this.isLoginMode = true;
                this.init();
            }
            
            init() {
                this.setupEventListeners();
                this.updateUI();
            }
            
            setupEventListeners() {
                // Login/Signup buttons
                document.getElementById('loginBtn').addEventListener('click', () => {
                    this.openAuthModal(true);
                });
                
                document.getElementById('signupBtn').addEventListener('click', () => {
                    this.openAuthModal(false);
                });
                
                // Logout button
                document.getElementById('logoutBtn').addEventListener('click', () => {
                    this.logout();
                });
                
                // Auth modal close button
                document.getElementById('authCloseModal').addEventListener('click', () => {
                    this.closeAuthModal();
                });
                
                // Auth form submit
                document.getElementById('authForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.handleAuthSubmit();
                });
                
                // Auth mode switch
                document.getElementById('authSwitchLink').addEventListener('click', () => {
                    this.toggleAuthMode();
                });
                
                // Password toggle
                document.getElementById('passwordToggle').addEventListener('click', () => {
                    this.togglePasswordVisibility();
                });
                
                // Close modal on ESC
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && document.getElementById('authModal').classList.contains('active')) {
                        this.closeAuthModal();
                    }
                });
            }
            
            openAuthModal(isLogin = true) {
                this.isLoginMode = isLogin;
                this.updateAuthModal();
                document.getElementById('authModal').classList.add('active');
                document.body.style.overflow = 'hidden';
                
                // Focus on email field
                setTimeout(() => {
                    document.getElementById('authEmail').focus();
                }, 100);
            }
            
            closeAuthModal() {
                document.getElementById('authModal').classList.remove('active');
                document.body.style.overflow = '';
                this.clearAuthForm();
            }
            
            toggleAuthMode() {
                this.isLoginMode = !this.isLoginMode;
                this.updateAuthModal();
            }
            
            updateAuthModal() {
                const title = document.getElementById('authModalTitle');
                const submitBtn = document.getElementById('authSubmitBtn');
                const switchText = document.getElementById('authSwitchText');
                const switchLink = document.getElementById('authSwitchLink');
                
                if (this.isLoginMode) {
                    title.textContent = 'Login';
                    submitBtn.innerHTML = '<i class="fas fa-sign-in-alt"></i> Login';
                    submitBtn.textContent = 'Login';
                    switchText.textContent = "Don't have an account?";
                    switchLink.textContent = 'Sign Up';
                } else {
                    title.textContent = 'Sign Up';
                    submitBtn.innerHTML = '<i class="fas fa-user-plus"></i> Sign Up';
                    submitBtn.textContent = 'Sign Up';
                    switchText.textContent = "Already have an account?";
                    switchLink.textContent = 'Login';
                }
                
                this.clearAuthError();
            }
            
            async handleAuthSubmit() {
                const email = document.getElementById('authEmail').value.trim();
                const password = document.getElementById('authPassword').value;
                
                // Basic validation
                if (!email || !password) {
                    this.showAuthError('Please fill in all fields');
                    return;
                }
                
                let result;
                
                if (this.isLoginMode) {
                    result = this.authSystem.login(email, password);
                } else {
                    result = this.authSystem.signup(email, password);
                }
                
                if (result.success) {
                    this.showNotification(
                        this.isLoginMode ? 'Login successful!' : 'Account created successfully!',
                        'success'
                    );
                    
                    this.closeAuthModal();
                    this.updateUI();
                    
                    // Refresh games if needed
                    if (this.platform) {
                        this.platform.loadGames();
                    }
                } else {
                    this.showAuthError(result.message || 'Authentication failed');
                }
            }
            
            logout() {
                this.authSystem.logout();
                this.showNotification('Logged out successfully', 'success');
                this.updateUI();
                
                // Refresh games to hide user-specific content
                if (this.platform) {
                    this.platform.loadGames();
                }
            }
            
            updateUI() {
                const currentUser = this.authSystem.getCurrentUser();
                const authButtons = document.querySelector('.auth-buttons');
                const userMenu = document.getElementById('userMenu');
                const userAvatar = document.getElementById('userAvatar');
                const userName = document.getElementById('userName');
                
                if (currentUser) {
                    // User is logged in
                    authButtons.style.display = 'none';
                    userMenu.classList.add('active');
                    
                    // Set user info
                    const initials = currentUser.name
                        .split(' ')
                        .map(n => n[0])
                        .join('')
                        .toUpperCase()
                        .substring(0, 2);
                    
                    userAvatar.textContent = initials;
                    userName.textContent = currentUser.name;
                } else {
                    // User is not logged in
                    authButtons.style.display = 'flex';
                    userMenu.classList.remove('active');
                }
            }
            
            togglePasswordVisibility() {
                const passwordInput = document.getElementById('authPassword');
                const toggleButton = document.getElementById('passwordToggle');
                const icon = toggleButton.querySelector('i');
                
                if (passwordInput.type === 'password') {
                    passwordInput.type = 'text';
                    icon.className = 'fas fa-eye-slash';
                    toggleButton.setAttribute('aria-label', 'Hide password');
                } else {
                    passwordInput.type = 'password';
                    icon.className = 'fas fa-eye';
                    toggleButton.setAttribute('aria-label', 'Show password');
                }
            }
            
            clearAuthForm() {
                document.getElementById('authEmail').value = '';
                document.getElementById('authPassword').value = '';
                this.clearAuthError();
            }
            
            showAuthError(message) {
                const errorElement = document.getElementById('authError');
                errorElement.textContent = message;
                errorElement.classList.add('show');
            }
            
            clearAuthError() {
                const errorElement = document.getElementById('authError');
                errorElement.classList.remove('show');
            }
            
            showNotification(message, type = 'success') {
                const notification = document.getElementById('notification');
                notification.textContent = message;
                notification.className = `notification ${type} show`;
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
            
            getCurrentUser() {
                return this.authSystem.getCurrentUser();
            }
            
            isLoggedIn() {
                return this.authSystem.getCurrentUser() !== null;
            }
        }

        // ============================
        // MAIN APPLICATION
        // ============================
        class GamePlatform {
            constructor() {
                this.storage = new GameStorage();
                this.authSystem = new UserAuth();
                this.authUI = new AuthUIManager(this.authSystem, this);
                this.uploadHandler = new GameUploadHandler();
                this.gamePlayer = new GamePlayer();
                this.gamePlayer.setPlatform(this);
                this.currentFilter = 'all';
                this.currentSearch = '';
                
                // Default sample games - REMOVED CODE BUILDER, ADDED SCIENCE GAME
                this.sampleGames = [
                    {
                        id: -1,
                        title: "Math Adventure",
                        category: "math",
                        ageRange: "8+",
                        description: "Solve math puzzles to progress through an adventure world. Practice addition, subtraction, multiplication, and division.",
                        type: "sample",
                        uploadDate: new Date().toISOString(),
                        playCount: 42,
                        mainFile: "math.html",
                        fileCount: 1,
                        totalSize: 1000
                    },
                    {
                        id: -2,
                        title: "Word Explorer",
                        category: "language",
                        ageRange: "10+",
                        description: "Build vocabulary by exploring islands filled with word challenges and puzzles.",
                        type: "sample",
                        uploadDate: new Date().toISOString(),
                        playCount: 28,
                        mainFile: "word.html",
                        fileCount: 1,
                        totalSize: 1000
                    },
                    {
                        id: -3,
                        title: "Science Quest",
                        category: "science",
                        ageRange: "10+",
                        description: "Test your science knowledge with this interactive quiz covering biology, chemistry, and physics!",
                        type: "sample",
                        uploadDate: new Date().toISOString(),
                        playCount: 35,
                        mainFile: "science.html",
                        fileCount: 1,
                        totalSize: 1000
                    }
                ];
            }
            
            init() {
                // Set current year
                document.getElementById('currentYear').textContent = new Date().getFullYear();
                
                // Load initial data
                this.loadGames();
                this.updateStats();
                this.setupEventListeners();
                this.setupUploadHandler();
                
                // Create demo HTML games
                this.createDemoGames();
            }
            
            getSampleGameById(id) {
                return this.sampleGames.find(game => game.id === id);
            }
            
            createDemoGames() {
                // Create simple HTML games for demonstration
                const demoGames = {
                    'math.html': this.createMathGame(),
                    'word.html': this.createWordGame(),
                    'science.html': this.createScienceGame() // REPLACED CODE BUILDER WITH SCIENCE GAME
                };
                
                // Add to sample games
                this.sampleGames.forEach(game => {
                    if (demoGames[game.mainFile]) {
                        if (!game.files) {
                            game.files = {};
                        }
                        game.files[game.mainFile] = {
                            name: game.mainFile,
                            content: demoGames[game.mainFile],
                            size: demoGames[game.mainFile].length,
                            type: 'text/html'
                        };
                    }
                });
            }
            
            createMathGame() {
                return `
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <meta charset="UTF-8">
                        <meta name="viewport" content="width=device-width, initial-scale=1.0">
                        <title>Math Adventure</title>
                        <style>
                            * {
                                margin: 0;
                                padding: 0;
                                box-sizing: border-box;
                            }
                            
                            body {
                                font-family: 'Arial', sans-serif;
                                background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
                                min-height: 100vh;
                                display: flex;
                                flex-direction: column;
                                align-items: center;
                                justify-content: center;
                                color: white;
                                padding: 20px;
                                overflow-x: hidden;
                            }
                            
                            .game-container {
                                max-width: 800px;
                                width: 100%;
                                background: rgba(255, 255, 255, 0.1);
                                backdrop-filter: blur(10px);
                                border-radius: 20px;
                                padding: 30px;
                                box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
                                border: 1px solid rgba(255, 255, 255, 0.2);
                                text-align: center;
                            }
                            
                            h1 {
                                font-size: 2.5rem;
                                margin-bottom: 10px;
                                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
                            }
                            
                            .subtitle {
                                font-size: 1.2rem;
                                margin-bottom: 30px;
                                opacity: 0.9;
                            }
                            
                            .stats {
                                display: flex;
                                justify-content: space-around;
                                margin-bottom: 30px;
                                flex-wrap: wrap;
                                gap: 20px;
                            }
                            
                            .stat-box {
                                background: rgba(255, 255, 255, 0.15);
                                padding: 15px 25px;
                                border-radius: 15px;
                                min-width: 120px;
                            }
                            
                            .stat-value {
                                font-size: 2rem;
                                font-weight: bold;
                                color: #ffd166;
                            }
                            
                            .game-area {
                                background: rgba(0, 0, 0, 0.3);
                                border-radius: 15px;
                                padding: 30px;
                                margin-bottom: 30px;
                            }
                            
                            .problem {
                                font-size: 2.8rem;
                                margin: 30px 0;
                                min-height: 80px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                font-weight: bold;
                            }
                            
                            .options {
                                display: grid;
                                grid-template-columns: repeat(2, 1fr);
                                gap: 20px;
                                margin-top: 20px;
                            }
                            
                            @media (max-width: 600px) {
                                .options {
                                    grid-template-columns: 1fr;
                                }
                            }
                            
                            .option {
                                background: rgba(255, 255, 255, 0.2);
                                border: none;
                                border-radius: 15px;
                                padding: 20px;
                                color: white;
                                font-size: 1.8rem;
                                cursor: pointer;
                                transition: all 0.3s;
                                font-weight: bold;
                            }
                            
                            .option:hover {
                                background: rgba(255, 255, 255, 0.3);
                                transform: translateY(-5px);
                                box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
                            }
                            
                            .option.correct {
                                background: #06d6a0;
                                color: white;
                                animation: pulse 0.5s;
                            }
                            
                            .option.incorrect {
                                background: #ef476f;
                                color: white;
                            }
                            
                            .controls {
                                display: flex;
                                justify-content: center;
                                gap: 20px;
                                margin-top: 20px;
                            }
                            
                            button {
                                background: #ffd166;
                                border: none;
                                border-radius: 15px;
                                padding: 15px 30px;
                                color: #333;
                                font-size: 1.2rem;
                                cursor: pointer;
                                transition: all 0.3s;
                                font-weight: bold;
                            }
                            
                            button:hover {
                                background: #ffc043;
                                transform: translateY(-3px);
                                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
                            }
                            
                            .feedback {
                                font-size: 1.5rem;
                                margin: 20px 0;
                                min-height: 40px;
                                transition: all 0.3s;
                            }
                            
                            .positive {
                                color: #06d6a0;
                            }
                            
                            .negative {
                                color: #ef476f;
                            }
                            
                            .level-indicator {
                                font-size: 1.2rem;
                                margin-bottom: 20px;
                                color: #ffd166;
                            }
                            
                            .timer {
                                font-size: 1.5rem;
                                margin: 10px 0;
                                color: #ffd166;
                            }
                            
                            @keyframes pulse {
                                0% { transform: scale(1); }
                                50% { transform: scale(1.1); }
                                100% { transform: scale(1); }
                            }
                            
                            @keyframes fadeIn {
                                from { opacity: 0; transform: translateY(20px); }
                                to { opacity: 1; transform: translateY(0); }
                            }
                            
                            .fade-in {
                                animation: fadeIn 0.5s ease-out;
                            }
                        </style>
                    </head>
                    <body>
                        <div class="game-container">
                            <h1>Math Adventure</h1>
                            <p class="subtitle">Solve math problems to earn points and level up!</p>
                            
                            <div class="stats">
                                <div class="stat-box">
                                    <div class="stat-label">Score</div>
                                    <div class="stat-value" id="score">0</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-label">Level</div>
                                    <div class="stat-value" id="level">1</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-label">Streak</div>
                                    <div class="stat-value" id="streak">0</div>
                                </div>
                            </div>
                            
                            <div class="level-indicator" id="levelIndicator">Basic Addition</div>
                            <div class="timer" id="timer">Time: 30s</div>
                            
                            <div class="game-area">
                                <div class="problem fade-in" id="problem">5 + 3 = ?</div>
                                
                                <div class="feedback" id="feedback"></div>
                                
                                <div class="options">
                                    <button class="option" id="option1" onclick="checkAnswer(this)">8</button>
                                    <button class="option" id="option2" onclick="checkAnswer(this)">7</button>
                                    <button class="option" id="option3" onclick="checkAnswer(this)">9</button>
                                    <button class="option" id="option4" onclick="checkAnswer(this)">6</button>
                                </div>
                            </div>
                            
                            <div class="controls">
                                <button onclick="generateProblem()">Skip Question</button>
                                <button onclick="resetGame()">Restart Game</button>
                            </div>
                        </div>
                        
                        <script>
                            let score = 0;
                            let level = 1;
                            let streak = 0;
                            let correctAnswer = 0;
                            let timer = 30;
                            let timerInterval;
                            
                            const operations = ['+', '-', '', ''];
                            const levelNames = [
                                "Basic Addition",
                                "Basic Subtraction", 
                                "Mixed Operations",
                                "Multiplication",
                                "Division",
                                "Advanced Challenge"
                            ];
                            
                            function getRandomNumber(min, max) {
                                return Math.floor(Math.random() * (max - min + 1)) + min;
                            }
                            
                            function generateProblem() {
                                clearInterval(timerInterval);
                                
                                let num1, num2, operation, answer;
                                
                                // Adjust difficulty based on level
                                if (level <= 2) {
                                    // Level 1-2: Simple addition/subtraction
                                    num1 = getRandomNumber(1, 10 + level * 5);
                                    num2 = getRandomNumber(1, 10 + level * 5);
                                    operation = operations[level - 1];
                                } else if (level <= 4) {
                                    // Level 3-4: Mixed operations with larger numbers
                                    num1 = getRandomNumber(10, 50);
                                    num2 = getRandomNumber(1, 20);
                                    operation = operations[getRandomNumber(0, 2)];
                                } else {
                                    // Level 5+: All operations with even larger numbers
                                    num1 = getRandomNumber(20, 100);
                                    num2 = getRandomNumber(1, 50);
                                    operation = operations[getRandomNumber(0, 3)];
                                }
                                
                                // Calculate correct answer
                                switch(operation) {
                                    case '+':
                                        answer = num1 + num2;
                                        break;
                                    case '-':
                                        answer = num1 - num2;
                                        break;
                                    case '':
                                        answer = num1 * num2;
                                        break;
                                    case '':
                                        // Ensure division results in integer
                                        answer = num1;
                                        num1 = num1 * num2;
                                        break;
                                }
                                
                                correctAnswer = answer;
                                
                                // Display problem
                                document.getElementById('problem').textContent = \`\${num1} \${operation} \${num2} = ?\`;
                                document.getElementById('problem').classList.add('fade-in');
                                
                                setTimeout(() => {
                                    document.getElementById('problem').classList.remove('fade-in');
                                }, 500);
                                
                                // Generate answer options
                                const options = [answer];
                                
                                // Add 3 wrong answers
                                while (options.length < 4) {
                                    let wrongAnswer;
                                    const variation = getRandomNumber(-10, 10);
                                    wrongAnswer = answer + variation;
                                    
                                    // Ensure wrong answer is different and not zero
                                    if (!options.includes(wrongAnswer) && wrongAnswer !== 0) {
                                        options.push(wrongAnswer);
                                    }
                                }
                                
                                // Shuffle options
                                options.sort(() => Math.random() - 0.5);
                                
                                // Assign to buttons
                                for (let i = 1; i <= 4; i++) {
                                    const button = document.getElementById(\`option\${i}\`);
                                    button.textContent = options[i-1];
                                    button.className = 'option';
                                    button.disabled = false;
                                }
                                
                                // Reset timer
                                timer = 30;
                                document.getElementById('timer').textContent = \`Time: \${timer}s\`;
                                document.getElementById('feedback').textContent = '';
                                document.getElementById('feedback').className = 'feedback';
                                
                                // Start timer
                                timerInterval = setInterval(() => {
                                    timer--;
                                    document.getElementById('timer').textContent = \`Time: \${timer}s\`;
                                    
                                    if (timer <= 0) {
                                        clearInterval(timerInterval);
                                        document.getElementById('feedback').textContent = "Time's up!";
                                        document.getElementById('feedback').className = 'feedback negative';
                                        streak = 0;
                                        document.getElementById('streak').textContent = streak;
                                        
                                        // Disable buttons
                                        for (let i = 1; i <= 4; i++) {
                                            document.getElementById(\`option\${i}\`).disabled = true;
                                        }
                                        
                                        setTimeout(generateProblem, 1500);
                                    }
                                }, 1000);
                            }
                            
                            function checkAnswer(button) {
                                clearInterval(timerInterval);
                                
                                const selectedAnswer = parseInt(button.textContent);
                                const feedback = document.getElementById('feedback');
                                
                                // Disable all buttons
                                for (let i = 1; i <= 4; i++) {
                                    document.getElementById(\`option\${i}\`).disabled = true;
                                }
                                
                                if (selectedAnswer === correctAnswer) {
                                    // Correct answer
                                    button.classList.add('correct');
                                    feedback.textContent = "Correct! ";
                                    feedback.className = 'feedback positive';
                                    
                                    // Update score and streak
                                    const points = Math.max(10, 30 - timer); // More points for faster answers
                                    score += points;
                                    streak++;
                                    
                                    // Check for level up
                                    if (streak >= 5 && level < 6) {
                                        level++;
                                        streak = 0;
                                        feedback.textContent += " Level Up! ";
                                    }
                                } else {
                                    // Wrong answer
                                    button.classList.add('incorrect');
                                    feedback.textContent = \`Wrong! The answer was \${correctAnswer}\`;
                                    feedback.className = 'feedback negative';
                                    streak = 0;
                                    
                                    // Highlight correct answer
                                    for (let i = 1; i <= 4; i++) {
                                        const btn = document.getElementById(\`option\${i}\`);
                                        if (parseInt(btn.textContent) === correctAnswer) {
                                            btn.classList.add('correct');
                                        }
                                    }
                                }
                                
                                // Update display
                                document.getElementById('score').textContent = score;
                                document.getElementById('level').textContent = level;
                                document.getElementById('streak').textContent = streak;
                                document.getElementById('levelIndicator').textContent = levelNames[level - 1];
                                
                                // Generate new problem after delay
                                setTimeout(generateProblem, 2000);
                            }
                            
                            function resetGame() {
                                score = 0;
                                level = 1;
                                streak = 0;
                                
                                document.getElementById('score').textContent = score;
                                document.getElementById('level').textContent = level;
                                document.getElementById('streak').textContent = streak;
                                document.getElementById('levelIndicator').textContent = levelNames[level - 1];
                                
                                clearInterval(timerInterval);
                                generateProblem();
                            }
                            
                            // Initialize game
                            generateProblem();
                        <\/script>
                    </body>
                    </html>
                `;
            }
            
            createWordGame() {
                return `
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <meta charset="UTF-8">
                        <meta name="viewport" content="width=device-width, initial-scale=1.0">
                        <title>Word Explorer</title>
                        <style>
                            * {
                                margin: 0;
                                padding: 0;
                                box-sizing: border-box;
                            }
                            
                            body {
                                font-family: 'Georgia', serif;
                                background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
                                min-height: 100vh;
                                display: flex;
                                flex-direction: column;
                                align-items: center;
                                justify-content: center;
                                color: #2d3436;
                                padding: 20px;
                            }
                            
                            .game-container {
                                max-width: 900px;
                                width: 100%;
                                background: rgba(255, 255, 255, 0.95);
                                border-radius: 20px;
                                padding: 40px;
                                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
                                text-align: center;
                            }
                            
                            h1 {
                                font-size: 3rem;
                                margin-bottom: 10px;
                                color: #2d3436;
                                background: linear-gradient(90deg, #11998e, #38ef7d);
                                -webkit-background-clip: text;
                                -webkit-text-fill-color: transparent;
                                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
                            }
                            
                            .subtitle {
                                font-size: 1.3rem;
                                margin-bottom: 30px;
                                color: #636e72;
                            }
                            
                            .game-area {
                                display: grid;
                                grid-template-columns: 1fr 1fr;
                                gap: 30px;
                                margin-bottom: 30px;
                            }
                            
                            @media (max-width: 768px) {
                                .game-area {
                                    grid-template-columns: 1fr;
                                }
                            }
                            
                            .word-section {
                                background: #f8f9fa;
                                border-radius: 15px;
                                padding: 30px;
                                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
                            }
                            
                            .category {
                                font-size: 1.5rem;
                                margin-bottom: 20px;
                                color: #11998e;
                                font-weight: bold;
                            }
                            
                            .word-display {
                                font-size: 2.5rem;
                                letter-spacing: 10px;
                                margin: 30px 0;
                                font-family: 'Courier New', monospace;
                                font-weight: bold;
                                color: #2d3436;
                                min-height: 60px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                flex-wrap: wrap;
                            }
                            
                            .letter-box {
                                display: inline-block;
                                width: 50px;
                                height: 60px;
                                margin: 0 5px;
                                border-bottom: 3px solid #11998e;
                                text-align: center;
                                line-height: 60px;
                                font-size: 2rem;
                                font-weight: bold;
                            }
                            
                            .letter-box.filled {
                                color: #2d3436;
                                animation: pop 0.3s;
                            }
                            
                            .hint-box {
                                background: #e3f2fd;
                                border-radius: 10px;
                                padding: 20px;
                                margin: 20px 0;
                                font-size: 1.1rem;
                                color: #1976d2;
                                border-left: 4px solid #1976d2;
                            }
                            
                            .keyboard {
                                display: flex;
                                flex-direction: column;
                                gap: 10px;
                                margin-top: 20px;
                            }
                            
                            .keyboard-row {
                                display: flex;
                                justify-content: center;
                                gap: 8px;
                                flex-wrap: wrap;
                            }
                            
                            .key {
                                width: 50px;
                                height: 50px;
                                background: #ffffff;
                                border: 2px solid #dfe6e9;
                                border-radius: 10px;
                                font-size: 1.3rem;
                                font-weight: bold;
                                cursor: pointer;
                                transition: all 0.2s;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                color: #2d3436;
                            }
                            
                            .key:hover {
                                background: #f1f2f6;
                                transform: translateY(-2px);
                                box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
                            }
                            
                            .key.used {
                                background: #b2bec3;
                                color: #636e72;
                                cursor: not-allowed;
                                transform: none;
                                box-shadow: none;
                            }
                            
                            .key.correct {
                                background: #00b894;
                                color: white;
                                border-color: #00b894;
                            }
                            
                            .key.wrong {
                                background: #d63031;
                                color: white;
                                border-color: #d63031;
                            }
                            
                            .controls-section {
                                background: #f8f9fa;
                                border-radius: 15px;
                                padding: 30px;
                                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
                            }
                            
                            .stats {
                                display: grid;
                                grid-template-columns: repeat(3, 1fr);
                                gap: 20px;
                                margin-bottom: 30px;
                            }
                            
                            .stat-item {
                                background: white;
                                border-radius: 10px;
                                padding: 20px;
                                box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
                            }
                            
                            .stat-label {
                                font-size: 0.9rem;
                                color: #636e72;
                                margin-bottom: 5px;
                            }
                            
                            .stat-value {
                                font-size: 2rem;
                                font-weight: bold;
                                color: #11998e;
                            }
                            
                            .hint-section {
                                background: white;
                                border-radius: 10px;
                                padding: 20px;
                                margin-bottom: 30px;
                                box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
                            }
                            
                            .hint-title {
                                font-size: 1.2rem;
                                color: #11998e;
                                margin-bottom: 10px;
                            }
                            
                            .hint-text {
                                font-size: 1.1rem;
                                color: #2d3436;
                                line-height: 1.5;
                            }
                            
                            .controls {
                                display: flex;
                                justify-content: center;
                                gap: 20px;
                                flex-wrap: wrap;
                            }
                            
                            button {
                                background: #11998e;
                                border: none;
                                border-radius: 10px;
                                padding: 15px 30px;
                                color: white;
                                font-size: 1.1rem;
                                cursor: pointer;
                                transition: all 0.3s;
                                font-weight: bold;
                                display: flex;
                                align-items: center;
                                gap: 10px;
                            }
                            
                            button:hover {
                                background: #0d7c73;
                                transform: translateY(-3px);
                                box-shadow: 0 10px 20px rgba(17, 153, 142, 0.3);
                            }
                            
                            button.secondary {
                                background: #636e72;
                            }
                            
                            button.secondary:hover {
                                background: #4a5357;
                                box-shadow: 0 10px 20px rgba(99, 110, 114, 0.3);
                            }
                            
                            .message {
                                font-size: 1.3rem;
                                margin: 20px 0;
                                min-height: 30px;
                                font-weight: bold;
                                transition: all 0.3s;
                            }
                            
                            .success {
                                color: #00b894;
                            }
                            
                            .error {
                                color: #d63031;
                            }
                            
                            .progress-bar {
                                height: 10px;
                                background: #dfe6e9;
                                border-radius: 5px;
                                margin: 20px 0;
                                overflow: hidden;
                            }
                            
                            .progress-fill {
                                height: 100%;
                                background: #11998e;
                                width: 100%;
                                transition: width 0.3s;
                            }
                            
                            @keyframes pop {
                                0% { transform: scale(1); }
                                50% { transform: scale(1.2); }
                                100% { transform: scale(1); }
                            }
                            
                            @keyframes shake {
                                0%, 100% { transform: translateX(0); }
                                25% { transform: translateX(-5px); }
                                75% { transform: translateX(5px); }
                            }
                            
                            .shake {
                                animation: shake 0.3s;
                            }
                        </style>
                    </head>
                    <body>
                        <div class="game-container">
                            <h1>Word Explorer</h1>
                            <p class="subtitle">Discover hidden words and expand your vocabulary!</p>
                            
                            <div class="game-area">
                                <div class="word-section">
                                    <div class="category" id="category">Category: Animals</div>
                                    
                                    <div class="word-display" id="wordDisplay">
                                        <!-- Word letters will appear here -->
                                    </div>
                                    
                                    <div class="hint-box" id="hintBox">
                                        Hint: This animal lives in the jungle and is known as the king of beasts.
                                    </div>
                                    
                                    <div class="keyboard" id="keyboard">
                                        <!-- Keyboard will be generated here -->
                                    </div>
                                </div>
                                
                                <div class="controls-section">
                                    <div class="stats">
                                        <div class="stat-item">
                                            <div class="stat-label">Score</div>
                                            <div class="stat-value" id="score">0</div>
                                        </div>
                                        <div class="stat-item">
                                            <div class="stat-label">Words Found</div>
                                            <div class="stat-value" id="wordsFound">0</div>
                                        </div>
                                        <div class="stat-item">
                                            <div class="stat-label">Attempts Left</div>
                                            <div class="stat-value" id="attempts">6</div>
                                        </div>
                                    </div>
                                    
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="progressFill" style="width: 100%"></div>
                                    </div>
                                    
                                    <div class="message" id="message">Guess the word! Click on letters.</div>
                                    
                                    <div class="hint-section">
                                        <div class="hint-title">Word Definition</div>
                                        <div class="hint-text" id="definition">A large carnivorous feline mammal of Africa and northwest India...</div>
                                    </div>
                                    
                                    <div class="controls">
                                        <button onclick="getHint()">
                                            <i class="fas fa-lightbulb"></i> Get Hint
                                        </button>
                                        <button onclick="skipWord()" class="secondary">
                                            <i class="fas fa-forward"></i> Skip Word
                                        </button>
                                        <button onclick="resetGame()">
                                            <i class="fas fa-redo"></i> Restart
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <script>
                            const wordCategories = {
                                animals: [
                                    { word: "LION", hint: "King of the jungle", definition: "A large carnivorous feline mammal of Africa and northwest India, with a tawny coat and a tufted tail, especially the male." },
                                    { word: "ELEPHANT", hint: "Largest land animal", definition: "A very large plant-eating mammal with a prehensile trunk, long curved ivory tusks, and large ears." },
                                    { word: "GIRAFFE", hint: "Tallest animal", definition: "A large African mammal with a very long neck and forelegs, having a coat patterned with brown patches." },
                                    { word: "DOLPHIN", hint: "Intelligent sea creature", definition: "A small gregarious toothed whale that typically has a beaklike snout and a curved fin on the back." },
                                    { word: "PENGUIN", hint: "Flightless bird from Antarctica", definition: "A flightless black and white seabird of the southern hemisphere, with wings developed into flippers." }
                                ],
                                fruits: [
                                    { word: "BANANA", hint: "Yellow curved fruit", definition: "A long curved fruit with a yellow skin and soft sweet flesh." },
                                    { word: "PINEAPPLE", hint: "Tropical spiky fruit", definition: "A large tropical fruit with a tough orange-colored skin and sweet yellow flesh." },
                                    { word: "STRAWBERRY", hint: "Red berry with seeds on outside", definition: "A sweet soft red fruit with a seed-studded surface." },
                                    { word: "WATERMELON", hint: "Large juicy summer fruit", definition: "A large melon with a hard green rind and sweet watery red flesh." },
                                    { word: "BLUEBERRY", hint: "Small blue antioxidant-rich fruit", definition: "A small sweet blue-black edible berry that grows in clusters." }
                                ],
                                countries: [
                                    { word: "CANADA", hint: "Northern neighbor of USA", definition: "A country in North America known for maple syrup and hockey." },
                                    { word: "BRAZIL", hint: "Largest South American country", definition: "The largest country in both South America and Latin America." },
                                    { word: "JAPAN", hint: "Land of the rising sun", definition: "An island country in East Asia known for technology and cherry blossoms." },
                                    { word: "EGYPT", hint: "Home of the pyramids", definition: "A country in North Africa known for its ancient civilization and monuments." },
                                    { word: "AUSTRALIA", hint: "Land down under", definition: "A country and continent surrounded by the Indian and Pacific oceans." }
                                ]
                            };
                            
                            let currentCategory = 'animals';
                            let currentWordIndex = 0;
                            let score = 0;
                            let wordsFound = 0;
                            let attempts = 6;
                            let guessedLetters = new Set();
                            let currentWordObj = null;
                            
                            function initGame() {
                                // Select random category
                                const categories = Object.keys(wordCategories);
                                currentCategory = categories[Math.floor(Math.random() * categories.length)];
                                
                                // Select random word from category
                                const words = wordCategories[currentCategory];
                                currentWordIndex = Math.floor(Math.random() * words.length);
                                currentWordObj = words[currentWordIndex];
                                
                                // Reset game state
                                guessedLetters.clear();
                                attempts = 6;
                                
                                // Update displays
                                updateDisplays();
                                generateKeyboard();
                                
                                // Set initial message
                                document.getElementById('message').textContent = 'Guess the word! Click on letters.';
                                document.getElementById('message').className = 'message';
                            }
                            
                            function updateDisplays() {
                                // Update category
                                document.getElementById('category').textContent = \`Category: \${currentCategory.charAt(0).toUpperCase() + currentCategory.slice(1)}\`;
                                
                                // Update word display
                                const wordDisplay = document.getElementById('wordDisplay');
                                wordDisplay.innerHTML = '';
                                
                                for (const letter of currentWordObj.word) {
                                    const letterBox = document.createElement('div');
                                    letterBox.className = 'letter-box';
                                    
                                    if (guessedLetters.has(letter)) {
                                        letterBox.textContent = letter;
                                        letterBox.classList.add('filled');
                                    }
                                    
                                    wordDisplay.appendChild(letterBox);
                                }
                                
                                // Update hint and definition
                                document.getElementById('hintBox').textContent = \`Hint: \${currentWordObj.hint}\`;
                                document.getElementById('definition').textContent = currentWordObj.definition;
                                
                                // Update stats
                                document.getElementById('score').textContent = score;
                                document.getElementById('wordsFound').textContent = wordsFound;
                                document.getElementById('attempts').textContent = attempts;
                                
                                // Update progress bar
                                const progress = (attempts / 6) * 100;
                                document.getElementById('progressFill').style.width = \`\${progress}%\`;
                                
                                // Check if word is complete
                                const wordComplete = currentWordObj.word.split('').every(letter => guessedLetters.has(letter));
                                if (wordComplete) {
                                    wordFound();
                                }
                            }
                            
                            function generateKeyboard() {
                                const keyboard = document.getElementById('keyboard');
                                keyboard.innerHTML = '';
                                
                                const rows = [
                                    ['Q', 'W', 'E', 'R', 'T', 'Y', 'U', 'I', 'O', 'P'],
                                    ['A', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L'],
                                    ['Z', 'X', 'C', 'V', 'B', 'N', 'M']
                                ];
                                
                                rows.forEach(rowLetters => {
                                    const row = document.createElement('div');
                                    row.className = 'keyboard-row';
                                    
                                    rowLetters.forEach(letter => {
                                        const key = document.createElement('div');
                                        key.className = 'key';
                                        key.textContent = letter;
                                        key.onclick = () => guessLetter(letter);
                                        
                                        if (guessedLetters.has(letter)) {
                                            key.classList.add('used');
                                            if (currentWordObj.word.includes(letter)) {
                                                key.classList.add('correct');
                                            } else {
                                                key.classList.add('wrong');
                                            }
                                        }
                                        
                                        row.appendChild(key);
                                    });
                                    
                                    keyboard.appendChild(row);
                                });
                            }
                            
                            function guessLetter(letter) {
                                if (guessedLetters.has(letter) || attempts <= 0) return;
                                
                                guessedLetters.add(letter);
                                
                                if (currentWordObj.word.includes(letter)) {
                                    // Correct guess
                                    document.getElementById('message').textContent = \`Good guess! Found letter \${letter}\`;
                                    document.getElementById('message').className = 'message success';
                                    
                                    // Add points for correct guess
                                    const occurrences = (currentWordObj.word.match(new RegExp(letter, 'g')) || []).length;
                                    score += occurrences * 10;
                                } else {
                                    // Wrong guess
                                    document.getElementById('message').textContent = \`\${letter} is not in the word!\`;
                                    document.getElementById('message').className = 'message error';
                                    document.getElementById('message').classList.add('shake');
                                    
                                    setTimeout(() => {
                                        document.getElementById('message').classList.remove('shake');
                                    }, 300);
                                    
                                    attempts--;
                                    
                                    // Game over check
                                    if (attempts <= 0) {
                                        document.getElementById('message').textContent = \`Game over! The word was \${currentWordObj.word}\`;
                                        setTimeout(() => {
                                            nextWord();
                                        }, 2000);
                                    }
                                }
                                
                                updateDisplays();
                                generateKeyboard();
                            }
                            
                            function wordFound() {
                                // Calculate bonus points
                                const remainingAttemptsBonus = attempts * 5;
                                const timeBonus = 50; // Simplified
                                
                                const wordScore = 100 + remainingAttemptsBonus + timeBonus;
                                score += wordScore;
                                wordsFound++;
                                
                                document.getElementById('message').textContent = \`Congratulations! + \${wordScore} points!\`;
                                document.getElementById('message').className = 'message success';
                                
                                // Celebrate
                                const wordDisplay = document.getElementById('wordDisplay');
                                wordDisplay.classList.add('shake');
                                
                                setTimeout(() => {
                                    wordDisplay.classList.remove('shake');
                                    nextWord();
                                }, 1500);
                            }
                            
                            function nextWord() {
                                const words = wordCategories[currentCategory];
                                
                                // Find a new word
                                let newIndex;
                                do {
                                    newIndex = Math.floor(Math.random() * words.length);
                                } while (newIndex === currentWordIndex && words.length > 1);
                                
                                currentWordIndex = newIndex;
                                currentWordObj = words[currentWordIndex];
                                
                                // Reset for new word
                                guessedLetters.clear();
                                attempts = 6;
                                
                                updateDisplays();
                                generateKeyboard();
                                
                                document.getElementById('message').textContent = 'New word! Guess the word!';
                                document.getElementById('message').className = 'message';
                            }
                            
                            function getHint() {
                                if (score >= 20) {
                                    score -= 20;
                                    
                                    // Find a letter that hasn't been guessed
                                    const unguessedLetters = currentWordObj.word.split('').filter(letter => !guessedLetters.has(letter));
                                    
                                    if (unguessedLetters.length > 0) {
                                        const randomLetter = unguessedLetters[Math.floor(Math.random() * unguessedLetters.length)];
                                        guessedLetters.add(randomLetter);
                                        
                                        document.getElementById('message').textContent = \`Hint revealed letter \${randomLetter}!\`;
                                        document.getElementById('message').className = 'message success';
                                        
                                        updateDisplays();
                                        generateKeyboard();
                                    }
                                } else {
                                    document.getElementById('message').textContent = 'Not enough points for a hint!';
                                    document.getElementById('message').className = 'message error';
                                }
                            }
                            
                            function skipWord() {
                                if (score >= 10) {
                                    score -= 10;
                                    nextWord();
                                } else {
                                    document.getElementById('message').textContent = 'Not enough points to skip!';
                                    document.getElementById('message').className = 'message error';
                                }
                            }
                            
                            function resetGame() {
                                score = 0;
                                wordsFound = 0;
                                initGame();
                            }
                            
                            // Add keyboard support
                            document.addEventListener('keydown', (event) => {
                                const letter = event.key.toUpperCase();
                                if (/^[A-Z]$/.test(letter) && !guessedLetters.has(letter) && attempts > 0) {
                                    guessLetter(letter);
                                }
                                
                                // Spacebar to skip
                                if (event.code === 'Space') {
                                    event.preventDefault();
                                    skipWord();
                                }
                                
                                // Enter for hint
                                if (event.code === 'Enter') {
                                    event.preventDefault();
                                    getHint();
                                }
                            });
                            
                            // Initialize the game
                            initGame();
                        <\/script>
                    </body>
                    </html>
                `;
            }
            
            createScienceGame() {
                return `
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <meta charset="UTF-8">
                        <meta name="viewport" content="width=device-width, initial-scale=1.0">
                        <title>Science Quest</title>
                        <style>
                            * {
                                margin: 0;
                                padding: 0;
                                box-sizing: border-box;
                            }
                            
                            body {
                                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                                background: linear-gradient(135deg, #2c3e50 0%, #4a6fa5 100%);
                                min-height: 100vh;
                                display: flex;
                                flex-direction: column;
                                align-items: center;
                                justify-content: center;
                                color: white;
                                padding: 20px;
                            }
                            
                            .game-container {
                                max-width: 900px;
                                width: 100%;
                                background: rgba(255, 255, 255, 0.95);
                                border-radius: 20px;
                                padding: 40px;
                                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
                                color: #2c3e50;
                            }
                            
                            h1 {
                                font-size: 2.8rem;
                                margin-bottom: 10px;
                                background: linear-gradient(90deg, #2c3e50, #4a6fa5);
                                -webkit-background-clip: text;
                                -webkit-text-fill-color: transparent;
                                text-align: center;
                            }
                            
                            .subtitle {
                                font-size: 1.3rem;
                                margin-bottom: 30px;
                                color: #666;
                                text-align: center;
                            }
                            
                            .stats-bar {
                                display: flex;
                                justify-content: space-between;
                                background: #f0f5ff;
                                border-radius: 15px;
                                padding: 20px;
                                margin-bottom: 30px;
                                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
                            }
                            
                            .stat-item {
                                text-align: center;
                                flex: 1;
                            }
                            
                            .stat-label {
                                font-size: 0.9rem;
                                color: #666;
                                margin-bottom: 5px;
                            }
                            
                            .stat-value {
                                font-size: 2rem;
                                font-weight: bold;
                                color: #4a6fa5;
                            }
                            
                            .category-tabs {
                                display: flex;
                                justify-content: center;
                                gap: 10px;
                                margin-bottom: 30px;
                                flex-wrap: wrap;
                            }
                            
                            .category-tab {
                                padding: 12px 24px;
                                background: #f0f5ff;
                                border: none;
                                border-radius: 50px;
                                font-weight: 600;
                                cursor: pointer;
                                transition: all 0.3s;
                                color: #4a6fa5;
                            }
                            
                            .category-tab:hover {
                                background: #4a6fa5;
                                color: white;
                                transform: translateY(-3px);
                            }
                            
                            .category-tab.active {
                                background: #4a6fa5;
                                color: white;
                                box-shadow: 0 5px 15px rgba(74, 111, 165, 0.3);
                            }
                            
                            .question-container {
                                background: #f8f9fa;
                                border-radius: 15px;
                                padding: 30px;
                                margin-bottom: 30px;
                                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
                                min-height: 200px;
                                display: flex;
                                flex-direction: column;
                                justify-content: center;
                            }
                            
                            .question-number {
                                font-size: 1rem;
                                color: #666;
                                margin-bottom: 10px;
                            }
                            
                            .question-text {
                                font-size: 1.5rem;
                                font-weight: 600;
                                margin-bottom: 20px;
                                line-height: 1.4;
                            }
                            
                            .options-grid {
                                display: grid;
                                grid-template-columns: repeat(2, 1fr);
                                gap: 15px;
                                margin-bottom: 30px;
                            }
                            
                            @media (max-width: 768px) {
                                .options-grid {
                                    grid-template-columns: 1fr;
                                }
                            }
                            
                            .option {
                                background: white;
                                border: 2px solid #e0e0e0;
                                border-radius: 12px;
                                padding: 20px;
                                font-size: 1.1rem;
                                cursor: pointer;
                                transition: all 0.3s;
                                text-align: left;
                                font-weight: 500;
                            }
                            
                            .option:hover {
                                border-color: #4a6fa5;
                                transform: translateY(-3px);
                                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
                            }
                            
                            .option.correct {
                                background: #d4edda;
                                border-color: #5cb85c;
                                color: #155724;
                            }
                            
                            .option.incorrect {
                                background: #f8d7da;
                                border-color: #d9534f;
                                color: #721c24;
                            }
                            
                            .option.selected {
                                border-color: #4a6fa5;
                                background: #f0f5ff;
                            }
                            
                            .feedback {
                                padding: 20px;
                                border-radius: 12px;
                                margin-bottom: 20px;
                                font-weight: 600;
                                display: none;
                            }
                            
                            .feedback.correct {
                                background: #d4edda;
                                border: 2px solid #5cb85c;
                                color: #155724;
                                display: block;
                            }
                            
                            .feedback.incorrect {
                                background: #f8d7da;
                                border: 2px solid #d9534f;
                                color: #721c24;
                                display: block;
                            }
                            
                            .explanation {
                                background: #e3f2fd;
                                border-radius: 12px;
                                padding: 20px;
                                margin-bottom: 30px;
                                display: none;
                            }
                            
                            .explanation.show {
                                display: block;
                            }
                            
                            .explanation-title {
                                font-weight: bold;
                                color: #1976d2;
                                margin-bottom: 10px;
                            }
                            
                            .controls {
                                display: flex;
                                justify-content: center;
                                gap: 20px;
                                flex-wrap: wrap;
                            }
                            
                            .control-btn {
                                padding: 15px 30px;
                                background: #4a6fa5;
                                color: white;
                                border: none;
                                border-radius: 12px;
                                font-size: 1.1rem;
                                cursor: pointer;
                                transition: all 0.3s;
                                font-weight: 600;
                                display: flex;
                                align-items: center;
                                gap: 10px;
                            }
                            
                            .control-btn:hover {
                                background: #3a5a80;
                                transform: translateY(-3px);
                                box-shadow: 0 8px 20px rgba(74, 111, 165, 0.3);
                            }
                            
                            .control-btn.secondary {
                                background: #6b8cbc;
                            }
                            
                            .control-btn.secondary:hover {
                                background: #5a7ca5;
                            }
                            
                            .control-btn:disabled {
                                background: #cccccc;
                                cursor: not-allowed;
                                transform: none;
                                box-shadow: none;
                            }
                            
                            .progress-bar {
                                height: 8px;
                                background: #e0e0e0;
                                border-radius: 4px;
                                margin: 20px 0;
                                overflow: hidden;
                            }
                            
                            .progress-fill {
                                height: 100%;
                                background: #4a6fa5;
                                width: 0%;
                                transition: width 0.5s ease;
                            }
                            
                            .completion-screen {
                                text-align: center;
                                padding: 40px;
                                display: none;
                            }
                            
                            .completion-screen.show {
                                display: block;
                            }
                            
                            .score-display {
                                font-size: 4rem;
                                font-weight: bold;
                                color: #4a6fa5;
                                margin: 20px 0;
                            }
                            
                            .result-message {
                                font-size: 1.3rem;
                                margin-bottom: 30px;
                                color: #666;
                            }
                            
                            .trophy {
                                font-size: 5rem;
                                color: #ffd700;
                                margin: 20px 0;
                            }
                            
                            .timer {
                                font-size: 1.2rem;
                                color: #4a6fa5;
                                margin: 10px 0;
                                font-weight: bold;
                            }
                            
                            @keyframes pulse {
                                0% { transform: scale(1); }
                                50% { transform: scale(1.05); }
                                100% { transform: scale(1); }
                            }
                            
                            .pulse {
                                animation: pulse 0.5s;
                            }
                            
                            @keyframes fadeIn {
                                from { opacity: 0; transform: translateY(20px); }
                                to { opacity: 1; transform: translateY(0); }
                            }
                            
                            .fade-in {
                                animation: fadeIn 0.5s ease-out;
                            }
                        </style>
                    </head>
                    <body>
                        <div class="game-container">
                            <h1>Science Quest</h1>
                            <p class="subtitle">Test your science knowledge across different subjects!</p>
                            
                            <div class="stats-bar">
                                <div class="stat-item">
                                    <div class="stat-label">Score</div>
                                    <div class="stat-value" id="score">0</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-label">Questions</div>
                                    <div class="stat-value" id="question-counter">1/10</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-label">Correct</div>
                                    <div class="stat-value" id="correct-counter">0</div>
                                </div>
                            </div>
                            
                            <div class="progress-bar">
                                <div class="progress-fill" id="progress-fill" style="width: 10%"></div>
                            </div>
                            
                            <div class="category-tabs" id="category-tabs">
                                <!-- Categories will be generated here -->
                            </div>
                            
                            <div class="question-container fade-in" id="question-container">
                                <div class="question-number" id="question-number">Question 1 of 10</div>
                                <div class="question-text" id="question-text">Loading question...</div>
                                <div class="timer" id="timer">Time: 30s</div>
                            </div>
                            
                            <div class="feedback" id="feedback"></div>
                            
                            <div class="explanation" id="explanation">
                                <div class="explanation-title">Explanation</div>
                                <div id="explanation-text"></div>
                            </div>
                            
                            <div class="options-grid" id="options-grid">
                                <!-- Options will be generated here -->
                            </div>
                            
                            <div class="controls">
                                <button class="control-btn" id="submit-btn" disabled>
                                    <i class="fas fa-paper-plane"></i> Submit Answer
                                </button>
                                <button class="control-btn secondary" id="next-btn" disabled>
                                    <i class="fas fa-forward"></i> Next Question
                                </button>
                                <button class="control-btn secondary" id="hint-btn">
                                    <i class="fas fa-lightbulb"></i> Get Hint
                                </button>
                                <button class="control-btn" id="restart-btn">
                                    <i class="fas fa-redo"></i> Restart Quiz
                                </button>
                            </div>
                            
                            <div class="completion-screen" id="completion-screen">
                                <div class="trophy">
                                    <i class="fas fa-trophy"></i>
                                </div>
                                <h2>Quiz Complete!</h2>
                                <div class="score-display" id="final-score">0</div>
                                <div class="result-message" id="result-message">Calculating your result...</div>
                                <button class="control-btn" id="play-again-btn">
                                    <i class="fas fa-play"></i> Play Again
                                </button>
                            </div>
                        </div>
                        
                        <script>
                            // SCIENCE QUIZ DATA WITH CORRECT ANSWERS
                            const scienceQuestions = {
                                biology: [
                                    {
                                        question: "What is the powerhouse of the cell?",
                                        options: ["Nucleus", "Mitochondria", "Ribosome", "Endoplasmic Reticulum"],
                                        correctAnswer: 1,
                                        explanation: "Mitochondria are known as the powerhouse of the cell because they produce most of the cell's supply of adenosine triphosphate (ATP), used as a source of chemical energy."
                                    },
                                    {
                                        question: "Which part of the plant conducts photosynthesis?",
                                        options: ["Roots", "Stem", "Leaves", "Flowers"],
                                        correctAnswer: 2,
                                        explanation: "Leaves contain chlorophyll, which captures sunlight and converts carbon dioxide and water into glucose and oxygen through photosynthesis."
                                    },
                                    {
                                        question: "What is the largest organ in the human body?",
                                        options: ["Liver", "Skin", "Lungs", "Heart"],
                                        correctAnswer: 1,
                                        explanation: "The skin is the largest organ of the human body, with a total area of about 20 square feet. It protects our bodies from the environment and helps regulate body temperature."
                                    },
                                    {
                                        question: "Which blood type is known as the universal donor?",
                                        options: ["A+", "B-", "AB+", "O-"],
                                        correctAnswer: 3,
                                        explanation: "O-negative blood is considered the universal donor type because it can be transfused to patients with any blood type in emergency situations."
                                    },
                                    {
                                        question: "How many bones are in the adult human body?",
                                        options: ["206", "196", "216", "226"],
                                        correctAnswer: 0,
                                        explanation: "The adult human skeleton typically consists of 206 bones. Babies are born with around 270 bones, but many fuse together as they grow."
                                    }
                                ],
                                chemistry: [
                                    {
                                        question: "What is the chemical symbol for gold?",
                                        options: ["Go", "Gd", "Au", "Ag"],
                                        correctAnswer: 2,
                                        explanation: "Au is the chemical symbol for gold, derived from the Latin word 'aurum'. It has atomic number 79 and is one of the least reactive chemical elements."
                                    },
                                    {
                                        question: "What is the pH value of pure water?",
                                        options: ["5", "6", "7", "8"],
                                        correctAnswer: 2,
                                        explanation: "Pure water has a pH of 7, which is considered neutral. pH values below 7 are acidic, while values above 7 are basic or alkaline."
                                    },
                                    {
                                        question: "Which gas do plants absorb during photosynthesis?",
                                        options: ["Oxygen", "Nitrogen", "Carbon Dioxide", "Hydrogen"],
                                        correctAnswer: 2,
                                        explanation: "Plants absorb carbon dioxide (CO2) from the atmosphere during photosynthesis, using it along with water and sunlight to produce glucose and oxygen."
                                    },
                                    {
                                        question: "What is the most abundant gas in Earth's atmosphere?",
                                        options: ["Oxygen", "Carbon Dioxide", "Nitrogen", "Argon"],
                                        correctAnswer: 2,
                                        explanation: "Nitrogen makes up about 78% of Earth's atmosphere. Oxygen is the second most abundant at about 21%."
                                    },
                                    {
                                        question: "What is H2O commonly known as?",
                                        options: ["Hydrogen Peroxide", "Water", "Heavy Water", "Hydroxide"],
                                        correctAnswer: 1,
                                        explanation: "H2O is the chemical formula for water, consisting of two hydrogen atoms bonded to one oxygen atom."
                                    }
                                ],
                                physics: [
                                    {
                                        question: "What is the unit of measurement for force?",
                                        options: ["Watt", "Joule", "Newton", "Pascal"],
                                        correctAnswer: 2,
                                        explanation: "The newton (symbol: N) is the International System of Units (SI) derived unit of force. It is named after Isaac Newton in recognition of his work on classical mechanics."
                                    },
                                    {
                                        question: "What is the speed of light in a vacuum?",
                                        options: ["300,000 km/s", "150,000 km/s", "1,080,000 km/h", "299,792,458 m/s"],
                                        correctAnswer: 3,
                                        explanation: "The speed of light in a vacuum is exactly 299,792,458 meters per second (approximately 300,000 km/s). This is a fundamental constant of nature."
                                    },
                                    {
                                        question: "Which law states that every action has an equal and opposite reaction?",
                                        options: ["First Law of Motion", "Second Law of Motion", "Third Law of Motion", "Law of Gravitation"],
                                        correctAnswer: 2,
                                        explanation: "Newton's Third Law of Motion states: 'For every action, there is an equal and opposite reaction.' This means that forces always occur in pairs."
                                    },
                                    {
                                        question: "What type of energy is stored in a battery?",
                                        options: ["Kinetic Energy", "Thermal Energy", "Chemical Energy", "Nuclear Energy"],
                                        correctAnswer: 2,
                                        explanation: "Batteries store chemical energy that is converted into electrical energy when connected to a circuit. Different battery types use different chemical reactions."
                                    },
                                    {
                                        question: "Which planet has the strongest gravitational pull in our solar system?",
                                        options: ["Earth", "Saturn", "Jupiter", "Neptune"],
                                        correctAnswer: 2,
                                        explanation: "Jupiter has the strongest gravitational pull of all planets in our solar system due to its massive size. Its gravity is about 2.4 times stronger than Earth's."
                                    }
                                ],
                                astronomy: [
                                    {
                                        question: "What is the closest star to Earth?",
                                        options: ["Alpha Centauri", "Sirius", "The Sun", "Proxima Centauri"],
                                        correctAnswer: 2,
                                        explanation: "The Sun is the closest star to Earth, located at an average distance of about 93 million miles (150 million kilometers). It's the center of our solar system."
                                    },
                                    {
                                        question: "Which planet is known as the Red Planet?",
                                        options: ["Venus", "Mars", "Jupiter", "Saturn"],
                                        correctAnswer: 1,
                                        explanation: "Mars is known as the Red Planet due to its reddish appearance, which is caused by iron oxide (rust) on its surface."
                                    },
                                    {
                                        question: "What causes the phases of the Moon?",
                                        options: ["Earth's shadow on the Moon", "The Moon's rotation", "The Sun's light on different parts of the Moon", "The Moon's distance from Earth"],
                                        correctAnswer: 2,
                                        explanation: "The phases of the Moon are caused by the changing angles at which we see the sunlit portion of the Moon as it orbits Earth. The Moon doesn't produce its own light."
                                    },
                                    {
                                        question: "What is a light-year a measure of?",
                                        options: ["Time", "Distance", "Brightness", "Speed"],
                                        correctAnswer: 1,
                                        explanation: "A light-year is a unit of distance, not time. It's the distance that light travels in one year, approximately 9.46 trillion kilometers."
                                    },
                                    {
                                        question: "Which galaxy is our solar system part of?",
                                        options: ["Andromeda Galaxy", "Whirlpool Galaxy", "Milky Way Galaxy", "Triangulum Galaxy"],
                                        correctAnswer: 2,
                                        explanation: "Our solar system is located in the Milky Way Galaxy, a barred spiral galaxy that contains between 100-400 billion stars."
                                    }
                                ]
                            };
                            
                            // Game state
                            let currentCategory = 'biology';
                            let currentQuestionIndex = 0;
                            let score = 0;
                            let correctAnswers = 0;
                            let selectedOption = null;
                            let timer = 30;
                            let timerInterval;
                            let questions = [];
                            let totalQuestions = 10;
                            
                            // Initialize the game
                            function initGame() {
                                // Generate category tabs
                                generateCategoryTabs();
                                
                                // Select random questions from all categories
                                selectRandomQuestions();
                                
                                // Reset game state
                                resetGameState();
                                
                                // Load first question
                                loadQuestion();
                                
                                // Update UI
                                updateUI();
                            }
                            
                            function generateCategoryTabs() {
                                const categoryTabs = document.getElementById('category-tabs');
                                categoryTabs.innerHTML = '';
                                
                                Object.keys(scienceQuestions).forEach(category => {
                                    const button = document.createElement('button');
                                    button.className = 'category-tab' + (category === currentCategory ? ' active' : '');
                                    button.textContent = category.charAt(0).toUpperCase() + category.slice(1);
                                    button.onclick = () => switchCategory(category);
                                    categoryTabs.appendChild(button);
                                });
                            }
                            
                            function switchCategory(category) {
                                currentCategory = category;
                                document.querySelectorAll('.category-tab').forEach(btn => {
                                    btn.classList.remove('active');
                                    if (btn.textContent.toLowerCase() === category) {
                                        btn.classList.add('active');
                                    }
                                });
                                
                                // Select new questions from this category
                                selectRandomQuestions();
                                resetGameState();
                                loadQuestion();
                            }
                            
                            function selectRandomQuestions() {
                                questions = [];
                                const allQuestions = [];
                                
                                // Combine questions from all categories if "All" is selected
                                if (currentCategory === 'all') {
                                    Object.values(scienceQuestions).forEach(categoryQuestions => {
                                        allQuestions.push(...categoryQuestions);
                                    });
                                } else {
                                    allQuestions.push(...scienceQuestions[currentCategory]);
                                }
                                
                                // Shuffle and select questions
                                const shuffled = [...allQuestions].sort(() => Math.random() - 0.5);
                                questions = shuffled.slice(0, totalQuestions);
                            }
                            
                            function resetGameState() {
                                currentQuestionIndex = 0;
                                score = 0;
                                correctAnswers = 0;
                                selectedOption = null;
                                
                                // Hide completion screen
                                document.getElementById('completion-screen').classList.remove('show');
                                
                                // Show question container
                                document.getElementById('question-container').style.display = 'flex';
                                document.getElementById('options-grid').style.display = 'grid';
                                document.getElementById('feedback').style.display = 'none';
                                document.getElementById('explanation').classList.remove('show');
                                
                                // Reset buttons
                                document.getElementById('submit-btn').disabled = true;
                                document.getElementById('next-btn').disabled = true;
                            }
                            
                            function loadQuestion() {
                                clearInterval(timerInterval);
                                
                                if (currentQuestionIndex >= questions.length) {
                                    endGame();
                                    return;
                                }
                                
                                const question = questions[currentQuestionIndex];
                                
                                // Update question display
                                document.getElementById('question-number').textContent = \`Question \${currentQuestionIndex + 1} of \${questions.length}\`;
                                document.getElementById('question-text').textContent = question.question;
                                document.getElementById('question-container').classList.add('fade-in');
                                
                                // Update progress bar
                                const progress = ((currentQuestionIndex) / questions.length) * 100;
                                document.getElementById('progress-fill').style.width = \`\${progress}%\`;
                                
                                // Generate options
                                generateOptions(question.options);
                                
                                // Reset selection
                                selectedOption = null;
                                document.getElementById('submit-btn').disabled = true;
                                document.getElementById('next-btn').disabled = true;
                                document.getElementById('feedback').style.display = 'none';
                                document.getElementById('explanation').classList.remove('show');
                                
                                // Start timer
                                timer = 30;
                                document.getElementById('timer').textContent = \`Time: \${timer}s\`;
                                timerInterval = setInterval(updateTimer, 1000);
                                
                                // Remove fade-in class after animation
                                setTimeout(() => {
                                    document.getElementById('question-container').classList.remove('fade-in');
                                }, 500);
                            }
                            
                            function generateOptions(options) {
                                const optionsGrid = document.getElementById('options-grid');
                                optionsGrid.innerHTML = '';
                                
                                options.forEach((option, index) => {
                                    const optionElement = document.createElement('button');
                                    optionElement.className = 'option';
                                    optionElement.textContent = option;
                                    optionElement.onclick = () => selectOption(index, optionElement);
                                    optionsGrid.appendChild(optionElement);
                                });
                            }
                            
                            function selectOption(index, element) {
                                // Clear previous selection
                                document.querySelectorAll('.option').forEach(opt => {
                                    opt.classList.remove('selected');
                                });
                                
                                // Select new option
                                selectedOption = index;
                                element.classList.add('selected');
                                document.getElementById('submit-btn').disabled = false;
                            }
                            
                            function submitAnswer() {
                                if (selectedOption === null) return;
                                
                                clearInterval(timerInterval);
                                
                                const question = questions[currentQuestionIndex];
                                const isCorrect = selectedOption === question.correctAnswer;
                                const feedback = document.getElementById('feedback');
                                const explanation = document.getElementById('explanation');
                                const explanationText = document.getElementById('explanation-text');
                                
                                // Disable all options
                                document.querySelectorAll('.option').forEach((opt, index) => {
                                    opt.style.cursor = 'default';
                                    if (index === question.correctAnswer) {
                                        opt.classList.add('correct');
                                    } else if (index === selectedOption && !isCorrect) {
                                        opt.classList.add('incorrect');
                                    }
                                });
                                
                                // Show feedback
                                if (isCorrect) {
                                    feedback.textContent = 'Correct! ';
                                    feedback.className = 'feedback correct';
                                    score += 10 + Math.min(timer, 20); // Bonus for faster answers
                                    correctAnswers++;
                                } else {
                                    feedback.textContent = 'Incorrect. The correct answer is highlighted.';
                                    feedback.className = 'feedback incorrect';
                                }
                                
                                feedback.style.display = 'block';
                                
                                // Show explanation
                                explanationText.textContent = question.explanation;
                                explanation.classList.add('show');
                                
                                // Update score display
                                updateUI();
                                
                                // Enable next button
                                document.getElementById('submit-btn').disabled = true;
                                document.getElementById('next-btn').disabled = false;
                            }
                            
                            function nextQuestion() {
                                currentQuestionIndex++;
                                
                                if (currentQuestionIndex < questions.length) {
                                    loadQuestion();
                                } else {
                                    endGame();
                                }
                            }
                            
                            function updateTimer() {
                                timer--;
                                document.getElementById('timer').textContent = \`Time: \${timer}s\`;
                                
                                if (timer <= 0) {
                                    clearInterval(timerInterval);
                                    if (selectedOption !== null) {
                                        submitAnswer();
                                    } else {
                                        // Auto-submit if time runs out
                                        selectedOption = 0; // Select first option by default
                                        submitAnswer();
                                    }
                                }
                            }
                            
                            function getHint() {
                                const question = questions[currentQuestionIndex];
                                const correctIndex = question.correctAnswer;
                                const options = document.querySelectorAll('.option');
                                
                                // Highlight the correct answer slightly
                                options[correctIndex].classList.add('pulse');
                                options[correctIndex].style.boxShadow = '0 0 20px rgba(92, 184, 92, 0.5)';
                                
                                // Remove highlight after 2 seconds
                                setTimeout(() => {
                                    options[correctIndex].classList.remove('pulse');
                                    options[correctIndex].style.boxShadow = '';
                                }, 2000);
                                
                                // Deduct points for using hint
                                if (score >= 5) {
                                    score -= 5;
                                    updateUI();
                                }
                            }
                            
                            function updateUI() {
                                document.getElementById('score').textContent = score;
                                document.getElementById('question-counter').textContent = \`\${currentQuestionIndex + 1}/\${questions.length}\`;
                                document.getElementById('correct-counter').textContent = correctAnswers;
                            }
                            
                            function endGame() {
                                clearInterval(timerInterval);
                                
                                // Hide question area
                                document.getElementById('question-container').style.display = 'none';
                                document.getElementById('options-grid').style.display = 'none';
                                document.getElementById('feedback').style.display = 'none';
                                document.getElementById('explanation').classList.remove('show');
                                
                                // Calculate percentage
                                const percentage = Math.round((correctAnswers / questions.length) * 100);
                                
                                // Show completion screen
                                const completionScreen = document.getElementById('completion-screen');
                                const finalScore = document.getElementById('final-score');
                                const resultMessage = document.getElementById('result-message');
                                
                                finalScore.textContent = \`\${score} points\`;
                                
                                // Set result message based on performance
                                let message = '';
                                if (percentage === 100) {
                                    message = 'Perfect score! You are a science genius! ';
                                } else if (percentage >= 80) {
                                    message = 'Excellent work! You know your science facts! ';
                                } else if (percentage >= 60) {
                                    message = 'Good job! You have solid science knowledge. ';
                                } else if (percentage >= 40) {
                                    message = 'Not bad! Keep learning and try again. ';
                                } else {
                                    message = 'Keep practicing! Science is all about discovery. ';
                                }
                                
                                resultMessage.textContent = \`You got \${correctAnswers} out of \${questions.length} correct (\${percentage}%). \${message}\`;
                                
                                completionScreen.classList.add('show');
                                completionScreen.classList.add('fade-in');
                            }
                            
                            function restartGame() {
                                resetGameState();
                                selectRandomQuestions();
                                loadQuestion();
                                updateUI();
                            }
                            
                            // Event listeners
                            document.getElementById('submit-btn').addEventListener('click', submitAnswer);
                            document.getElementById('next-btn').addEventListener('click', nextQuestion);
                            document.getElementById('hint-btn').addEventListener('click', getHint);
                            document.getElementById('restart-btn').addEventListener('click', restartGame);
                            document.getElementById('play-again-btn').addEventListener('click', restartGame);
                            
                            // Keyboard support
                            document.addEventListener('keydown', (e) => {
                                // Number keys 1-4 for selecting options
                                if (e.key >= '1' && e.key <= '4') {
                                    const index = parseInt(e.key) - 1;
                                    const options = document.querySelectorAll('.option');
                                    if (options[index]) {
                                        selectOption(index, options[index]);
                                    }
                                }
                                
                                // Enter to submit
                                if (e.key === 'Enter') {
                                    if (!document.getElementById('next-btn').disabled) {
                                        nextQuestion();
                                    } else if (!document.getElementById('submit-btn').disabled) {
                                        submitAnswer();
                                    }
                                }
                                
                                // Space for hint
                                if (e.key === ' ' && !document.getElementById('submit-btn').disabled) {
                                    e.preventDefault();
                                    getHint();
                                }
                            });
                            
                            // Initialize the game
                            initGame();
                        <\/script>
                    </body>
                    </html>
                `;
            }
            
            loadGames() {
                const gamesGrid = document.getElementById('gamesGrid');
                const emptyState = document.getElementById('emptyState');
                
                // Get all games
                const storedGames = this.storage.getAllGames();
                const allGames = [...this.sampleGames, ...storedGames];
                
                // Filter games
                let filteredGames = allGames;
                
                if (this.currentFilter !== 'all') {
                    if (this.currentFilter === 'uploaded') {
                        // Only show user's uploaded games when logged in
                        const currentUser = this.authUI.getCurrentUser();
                        if (currentUser) {
                            filteredGames = this.storage.getUserGames(currentUser.id);
                        } else {
                            filteredGames = [];
                        }
                    } else {
                        filteredGames = allGames.filter(game => game.category === this.currentFilter);
                    }
                }
                
                if (this.currentSearch) {
                    const searchQuery = this.currentSearch.toLowerCase();
                    filteredGames = filteredGames.filter(game => 
                        game.title.toLowerCase().includes(searchQuery) ||
                        game.description.toLowerCase().includes(searchQuery) ||
                        game.category.toLowerCase().includes(searchQuery)
                    );
                }
                
                // Clear grid
                gamesGrid.innerHTML = '';
                
                // Show empty state if no games
                if (filteredGames.length === 0) {
                    emptyState.style.display = 'block';
                    gamesGrid.style.display = 'none';
                    return;
                }
                
                // Show grid
                emptyState.style.display = 'none';
                gamesGrid.style.display = 'grid';
                
                // Render games
                filteredGames.forEach(game => {
                    gamesGrid.appendChild(this.createGameCard(game));
                });
            }
            
            createGameCard(game) {
                const card = document.createElement('div');
                card.className = `game-card fade-in ${game.type === 'uploaded' ? 'uploaded' : ''}`;
                
                const colors = {
                    'math': ['#4a6fa5', '#6b8cbc'],
                    'science': ['#5cb85c', '#4cae4c'],
                    'language': ['#9b59b6', '#8e44ad'],
                    'coding': ['#2aa198', '#268bd2'],
                    'social': ['#d9534f', '#c9302c'],
                    'arts': ['#ff9e5d', '#ff8e42'],
                    'puzzle': ['#f0ad4e', '#ec971f'],
                    'other': ['#6b8cbc', '#4a6fa5']
                };
                
                const [color1, color2] = colors[game.category] || colors.other;
                const icons = {
                    'math': 'fas fa-calculator',
                    'science': 'fas fa-flask',
                    'language': 'fas fa-language',
                    'coding': 'fas fa-code',
                    'social': 'fas fa-globe-americas',
                    'arts': 'fas fa-palette',
                    'puzzle': 'fas fa-puzzle-piece',
                    'other': 'fas fa-gamepad'
                };
                
                card.innerHTML = `
                    <div class="game-image" style="background: linear-gradient(135deg, ${color1}, ${color2})">
                        <i class="${icons[game.category] || icons.other}"></i>
                        ${game.type === 'uploaded' ? '<span class="game-type-badge">Uploaded</span>' : ''}
                    </div>
                    <div class="game-info">
                        <h3>${game.title}</h3>
                        <div class="game-meta">
                            <span><i class="fas fa-tag"></i> ${this.formatCategory(game.category)}</span>
                            <span><i class="fas fa-user-graduate"></i> ${game.ageRange}</span>
                            <span><i class="fas fa-play-circle"></i> ${game.playCount || 0}</span>
                        </div>
                        <p class="game-desc">${game.description}</p>
                        <div class="game-actions">
                            <button class="play-btn" data-game-id="${game.id}">
                                <i class="fas fa-play"></i> Play Game
                            </button>
                            ${game.type === 'uploaded' && this.canDeleteGame(game) ? `
                                <button class="delete-btn" data-game-id="${game.id}">
                                    <i class="fas fa-trash"></i>
                                </button>
                            ` : ''}
                        </div>
                    </div>
                `;
                
                return card;
            }
            
            canDeleteGame(game) {
                const currentUser = this.authUI.getCurrentUser();
                return currentUser && game.userId === currentUser.id;
            }
            
            formatCategory(category) {
                const categories = {
                    'math': 'Mathematics',
                    'science': 'Science',
                    'language': 'Language Arts',
                    'coding': 'Programming',
                    'social': 'Social Studies',
                    'arts': 'Arts & Creativity',
                    'puzzle': 'Puzzle',
                    'other': 'Other'
                };
                return categories[category] || category;
            }
            
            updateStats() {
                const stats = this.storage.getStats();
                const samplePlays = this.sampleGames.reduce((sum, game) => sum + (game.playCount || 0), 0);
                
                document.getElementById('totalGames').textContent = stats.totalGames + this.sampleGames.length;
                document.getElementById('totalUploads').textContent = stats.totalUploads;
                document.getElementById('totalPlays').textContent = stats.totalPlays + samplePlays;
            }
            
            setupEventListeners() {
                // Filter buttons
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                        this.currentFilter = e.target.dataset.filter;
                        this.loadGames();
                    });
                });
                
                // Search input
                document.getElementById('gameSearch').addEventListener('input', (e) => {
                    this.currentSearch = e.target.value.toLowerCase();
                    this.loadGames();
                });
                
                // Play and delete buttons (event delegation)
                document.getElementById('gamesGrid').addEventListener('click', (e) => {
                    const playBtn = e.target.closest('.play-btn');
                    const deleteBtn = e.target.closest('.delete-btn');
                    
                    if (playBtn) {
                        const gameId = parseInt(playBtn.dataset.gameId);
                        this.gamePlayer.playGame(gameId);
                    }
                    
                    if (deleteBtn) {
                        const gameId = parseInt(deleteBtn.dataset.gameId);
                        if (confirm('Are you sure you want to delete this game? This action cannot be undone.')) {
                            this.deleteGame(gameId);
                        }
                    }
                });
                
                // Navigation buttons
                document.getElementById('browseGamesBtn').addEventListener('click', () => {
                    document.querySelector('#library').scrollIntoView({ behavior: 'smooth' });
                });
                
                document.getElementById('uploadHeroBtn').addEventListener('click', () => {
                    document.querySelector('#upload').scrollIntoView({ behavior: 'smooth' });
                });
                
                // Mobile menu
                const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
                const navList = document.querySelector('.nav-list');
                
                mobileMenuBtn.addEventListener('click', () => {
                    const isExpanded = mobileMenuBtn.getAttribute('aria-expanded') === 'true';
                    mobileMenuBtn.setAttribute('aria-expanded', !isExpanded);
                    navList.classList.toggle('active');
                    
                    const icon = mobileMenuBtn.querySelector('i');
                    icon.className = navList.classList.contains('active') ? 'fas fa-times' : 'fas fa-bars';
                });
                
                // Close mobile menu when clicking links
                document.querySelectorAll('.nav-list a').forEach(link => {
                    link.addEventListener('click', () => {
                        mobileMenuBtn.setAttribute('aria-expanded', 'false');
                        navList.classList.remove('active');
                        mobileMenuBtn.querySelector('i').className = 'fas fa-bars';
                    });
                });
                
                // Smooth scrolling
                document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                    anchor.addEventListener('click', function(e) {
                        const href = this.getAttribute('href');
                        if (href === '#') return;
                        
                        e.preventDefault();
                        const targetElement = document.querySelector(href);
                        if (targetElement) {
                            window.scrollTo({
                                top: targetElement.offsetTop - 80,
                                behavior: 'smooth'
                            });
                        }
                    });
                });
                
                // Close modal on ESC
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        if (document.getElementById('gameModal').classList.contains('active')) {
                            this.gamePlayer.closeGameModal();
                        }
                        if (document.getElementById('authModal').classList.contains('active')) {
                            this.authUI.closeAuthModal();
                        }
                    }
                });
                
                // Footer links
                ['devDocs', 'privacyPolicy', 'termsOfService'].forEach(id => {
                    document.getElementById(id).addEventListener('click', (e) => {
                        e.preventDefault();
                        this.showNotification(`${id.replace(/([A-Z])/g, ' $1')} would open here`, 'info');
                    });
                });
                
                // IMPROVEMENT: Add keyboard navigation for game cards
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        const focusedElement = document.activeElement;
                        if (focusedElement.classList.contains('play-btn')) {
                            const gameId = parseInt(focusedElement.dataset.gameId);
                            this.gamePlayer.playGame(gameId);
                        }
                    }
                });
            }
            
            setupUploadHandler() {
                const uploadBox = document.getElementById('uploadBox');
                const fileInput = document.getElementById('fileInput');
                const saveBtn = document.getElementById('saveGameBtn');
                const cancelBtn = document.getElementById('cancelUploadBtn');
                
                // Click to select files
                uploadBox.addEventListener('click', () => {
                    const currentUser = this.authUI.getCurrentUser();
                    if (!currentUser) {
                        this.authUI.openAuthModal(true);
                        this.showNotification('Please login to upload games', 'warning');
                        return;
                    }
                    fileInput.click();
                });
                
                uploadBox.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        const currentUser = this.authUI.getCurrentUser();
                        if (!currentUser) {
                            this.authUI.openAuthModal(true);
                            this.showNotification('Please login to upload games', 'warning');
                            return;
                        }
                        fileInput.click();
                    }
                });
                
                // Drag and drop improvements
                uploadBox.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    uploadBox.classList.add('dragover');
                });
                
                uploadBox.addEventListener('dragleave', () => {
                    uploadBox.classList.remove('dragover');
                });
                
                uploadBox.addEventListener('drop', (e) => {
                    e.preventDefault();
                    uploadBox.classList.remove('dragover');
                    
                    const currentUser = this.authUI.getCurrentUser();
                    if (!currentUser) {
                        this.authUI.openAuthModal(true);
                        this.showNotification('Please login to upload games', 'warning');
                        return;
                    }
                    
                    if (e.dataTransfer.files.length > 0) {
                        fileInput.files = e.dataTransfer.files;
                        const event = new Event('change', { bubbles: true });
                        fileInput.dispatchEvent(event);
                    }
                });
                
                // File input change
                fileInput.addEventListener('change', async (e) => {
                    const currentUser = this.authUI.getCurrentUser();
                    if (!currentUser) {
                        this.authUI.openAuthModal(true);
                        this.showNotification('Please login to upload games', 'warning');
                        return;
                    }
                    
                    try {
                        const files = Array.from(e.target.files);
                        if (files.length === 0) return;
                        
                        // Show upload details
                        document.getElementById('uploadDetails').style.display = 'block';
                        
                        // Update file list
                        const fileList = document.getElementById('fileList');
                        const mainFileSelect = document.getElementById('mainFile');
                        
                        fileList.innerHTML = '';
                        mainFileSelect.innerHTML = '<option value="">Select main HTML file</option>';
                        
                        let totalSize = 0;
                        
                        for (let i = 0; i < files.length; i++) {
                            const file = files[i];
                            totalSize += file.size;
                            
                            // Add to file list
                            const li = document.createElement('li');
                            li.innerHTML = `
                                <div class="file-info">
                                    <i class="fas fa-file${this.getFileIcon(file.name)}"></i>
                                    <span>${file.name}</span>
                                </div>
                                <span class="file-size">${this.formatFileSize(file.size)}</span>
                            `;
                            fileList.appendChild(li);
                            
                            // Add HTML files to main file selector
                            if (file.name.toLowerCase().endsWith('.html') || file.name.toLowerCase().endsWith('.htm')) {
                                const option = document.createElement('option');
                                option.value = file.name;
                                option.textContent = file.name;
                                mainFileSelect.appendChild(option);
                            }
                        }
                        
                        // Auto-fill game title from first HTML file
                        const firstHtmlFile = files.find(f => f.name.toLowerCase().endsWith('.html') || f.name.toLowerCase().endsWith('.htm'));
                        if (firstHtmlFile) {
                            const title = firstHtmlFile.name.replace(/\.(html|htm)$/i, '').replace(/[_-]/g, ' ');
                            document.getElementById('gameTitle').value = this.capitalizeWords(title);
                        }
                        
                        // Auto-select category based on game title
                        const titleInput = document.getElementById('gameTitle');
                        const title = titleInput.value.toLowerCase();
                        if (title.includes('math') || title.includes('calculat')) {
                            document.getElementById('gameCategory').value = 'math';
                        } else if (title.includes('scien') || title.includes('chem') || title.includes('physic') || title.includes('bio')) {
                            document.getElementById('gameCategory').value = 'science';
                        } else if (title.includes('word') || title.includes('vocab') || title.includes('language')) {
                            document.getElementById('gameCategory').value = 'language';
                        } else if (title.includes('code') || title.includes('program')) {
                            document.getElementById('gameCategory').value = 'coding';
                        }
                        
                        // Update progress (simulated)
                        const progressFill = document.getElementById('progressFill');
                        const progressText = document.getElementById('progressText');
                        const uploadProgress = document.getElementById('uploadProgress');
                        
                        uploadProgress.style.display = 'block';
                        
                        for (let i = 0; i <= 100; i += 10) {
                            await new Promise(resolve => setTimeout(resolve, 50));
                            progressFill.style.width = `${i}%`;
                            progressText.textContent = `Processing... ${i}%`;
                        }
                        
                        setTimeout(() => {
                            uploadProgress.style.display = 'none';
                            progressFill.style.width = '0%';
                            this.showNotification(`Loaded ${files.length} file(s) successfully`, 'success');
                        }, 500);
                        
                    } catch (error) {
                        this.showNotification(`Error loading files: ${error.message}`, 'error');
                    }
                });
                
                // Save game button
                saveBtn.addEventListener('click', async () => {
                    const currentUser = this.authUI.getCurrentUser();
                    if (!currentUser) {
                        this.authUI.openAuthModal(true);
                        this.showNotification('Please login to upload games', 'warning');
                        return;
                    }
                    
                    try {
                        const title = document.getElementById('gameTitle').value.trim();
                        const category = document.getElementById('gameCategory').value;
                        const description = document.getElementById('gameDescription').value.trim();
                        const ageRange = document.getElementById('gameAge').value.trim() || 'All ages';
                        const mainFile = document.getElementById('mainFile').value;
                        const files = fileInput.files;
                        
                        // Validation
                        if (!title || !category || !description || !mainFile || files.length === 0) {
                            throw new Error('Please fill in all required fields and select files');
                        }
                        
                        // Validate age range format
                        if (ageRange && !/^(\d+\+|\d+-\d+|All ages)$/.test(ageRange)) {
                            throw new Error('Age range should be in format like "8+", "12-16", or "All ages"');
                        }
                        
                        // Process files
                        const uploadHandler = new GameUploadHandler();
                        const processedFiles = await uploadHandler.processFiles(files);
                        
                        // Create game data
                        const gameData = {
                            title,
                            category,
                            description,
                            ageRange,
                            mainFile,
                            files: processedFiles.files,
                            totalSize: processedFiles.totalSize,
                            userId: currentUser.id
                        };
                        
                        // Save game
                        const savedGame = this.storage.saveGame(gameData);
                        
                        // Reset form
                        this.resetUploadForm();
                        
                        // Show success message
                        this.showNotification(`"${savedGame.title}" uploaded successfully!`, 'success');
                        
                        // Reload games
                        this.loadGames();
                        this.updateStats();
                        
                        // Scroll to library to show the new game
                        document.querySelector('#library').scrollIntoView({ behavior: 'smooth' });
                        
                    } catch (error) {
                        this.showNotification(`Upload failed: ${error.message}`, 'error');
                    }
                });
                
                // Cancel upload button
                cancelBtn.addEventListener('click', () => {
                    this.resetUploadForm();
                    this.showNotification('Upload cancelled', 'warning');
                });
            }
            
            resetUploadForm() {
                document.getElementById('fileInput').value = '';
                document.getElementById('uploadDetails').style.display = 'none';
                document.getElementById('gameTitle').value = '';
                document.getElementById('gameCategory').value = '';
                document.getElementById('gameDescription').value = '';
                document.getElementById('gameAge').value = '';
                document.getElementById('mainFile').innerHTML = '<option value="">Select main HTML file</option>';
                document.getElementById('fileList').innerHTML = '';
                document.getElementById('uploadProgress').style.display = 'none';
                document.getElementById('progressFill').style.width = '0%';
            }
            
            getFileIcon(filename) {
                if (filename.toLowerCase().endsWith('.html') || filename.toLowerCase().endsWith('.htm')) return '-code';
                if (filename.toLowerCase().endsWith('.js')) return '-code';
                if (filename.toLowerCase().endsWith('.css')) return '-code';
                if (filename.toLowerCase().endsWith('.png') || filename.toLowerCase().endsWith('.jpg') || filename.toLowerCase().endsWith('.jpeg')) return '-image';
                if (filename.toLowerCase().endsWith('.gif')) return '-image';
                return '';
            }
            
            formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }
            
            capitalizeWords(str) {
                return str.replace(/\b\w/g, char => char.toUpperCase());
            }
            
            deleteGame(gameId) {
                if (this.storage.deleteGame(gameId)) {
                    this.showNotification('Game deleted successfully', 'success');
                    this.loadGames();
                    this.updateStats();
                } else {
                    this.showNotification('Failed to delete game', 'error');
                }
            }
            
            showNotification(message, type = 'success') {
                const notification = document.getElementById('notification');
                notification.textContent = message;
                notification.className = `notification ${type} show`;
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
        }

        // ============================
        // INITIALIZE APPLICATION
        // ============================
        const platform = new GamePlatform();
        const gamePlayer = new GamePlayer();
        
        // Make gamePlayer globally accessible for inline event handlers
        window.gamePlayer = gamePlayer;
        
        document.addEventListener('DOMContentLoaded', () => {
            platform.init();
        });
        
        // Global functions for inline event handlers
        function scrollToUpload() {
            document.querySelector('#upload').scrollIntoView({ behavior: 'smooth' });
        }
        
        function closeGameModal() {
            gamePlayer.closeGameModal();
        }
        
        // For debugging
        window.platform = platform;
    </script>
</body>
</html>



